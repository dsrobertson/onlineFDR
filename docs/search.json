[{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"brief-background-of-the-onlinefdr-algorithms","dir":"Articles","previous_headings":"","what":"Brief Background of the onlineFDR algorithms","title":"Advanced usage of onlineFDR","text":"Javanmard Montanari proposed two procedures, LOND LORD, control FDR online manner (Javanmard Montanari (2015, 2018)), latter extended Ramdas et al. (2017). LOND procedure sets adjusted significance thresholds based number discoveries made far, LORD sets according time recent discovery. Ramdas et al. (2018) proposed SAFFRON procedure, provides adaptive method online FDR control. also proposed variant Alpha-investing algorithm Foster Stine (2008) guarantees FDR control, using SAFFRON’s update rule. Subsequently, Zrnic et al. (2021) proposed procedures control modified FDR (mFDR) context asynchronous testing, .e. hypothesis test can sequential process tests can overlap time. presented asynchronous versions LOND, LORD SAFFRON procedures variety trial settings. synchronous asynchronous testing, Tian & Ramdas (2019) proposed ADDIS algorithms compensate loss power presence conservative nulls adaptively ‘discarding’ p-values. Finally, Tian & Ramdas (2021) proposed procedures provide online control FWER. One procedure, online fallback, gives uniform improvement naive Alpha-spending procedure (see ). ADDIS-spending procedure compensates power loss procedures including adapativity fraction null hypotheses conservativeness nulls.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"variations-to-the-default-options","dir":"Articles","previous_headings":"","what":"Variations to the default options","title":"Advanced usage of onlineFDR","text":"following section, consider arguments typical user might consider amending analysis.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"common-arguments","dir":"Articles","previous_headings":"Variations to the default options","what":"Common arguments","title":"Advanced usage of onlineFDR","text":"default, alpha argument set 0.05, alpha sets overall significance level FDR FWER controlling procedure. convention, standard significance level utilised 5%. However, applications alternate threshold considered. example, stringent threshold might appropriate limited resources follow significant findings. less stringent threshold might appropriate downstream analysis global analysis can tolerate higher proportion false positives. ensure correct interpretation dates provided date.format argument. default, date format set receive dates year-month(00-12)-day(number). following website provides clear guidance symbols used interpret date information: https://stat.ethz.ch/R-manual/R-devel/library/base/html/strptime.html default, random argument set TRUE. situation, order p-values batch (.e. date) randomised. avoid risk p-values ordered post-hoc, can lead inflation FDR. dataset grows data reprocessed. ensure consistency output (randomisation within previous batches remaining ), necessary set seed analyses. user also option turn randomisation step, setting random argument FALSE. approach appropriate user date time stamp p-values, case data ordered date time beforehand passed wrapper function. Another scenario p-values within batches ordered using independent side information, hypotheses likely rejected come first, potentially increase power procedure (see Javanmard Montanari (2018) Li Barber (2017)).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"lond","dir":"Articles","previous_headings":"Variations to the default options","what":"LOND","title":"Advanced usage of onlineFDR","text":"default, dep argument set FALSE. Alternatively, can set TRUE implement LOND procedure guarantee FDR control arbitrarily dependent p-values. method general conservative. vector betai supplied default, can optionally specified user (described , see formula βj\\beta_jhere).","code":"set.seed(1); results.indep <- LOND(sample.df)    # for independent p-values set.seed(1); results.dep <- LOND(sample.df, dep=TRUE)   # for dependent p-values  # compare adjusted significance thresholds cbind(independent = results.indep$alphai, dependent = results.dep$alphai) #>        independent    dependent #>  [1,] 0.0026758385 0.0026758385 #>  [2,] 0.0011638206 0.0007758804 #>  [3,] 0.0009912499 0.0005406818 #>  [4,] 0.0008243606 0.0003956931 #>  [5,] 0.0006988870 0.0003060819 #>  [6,] 0.0006045900 0.0002467714 #>  [7,] 0.0005319444 0.0002051576 #>  [8,] 0.0007117838 0.0002618915 #>  [9,] 0.0006421423 0.0002269882 #> [10,] 0.0007796504 0.0002661860 #> [11,] 0.0007155186 0.0002369363 #> [12,] 0.0006610273 0.0002130140 #> [13,] 0.0006141682 0.0001931265 #> [14,] 0.0005734509 0.0001763616 #> [15,] 0.0005377472 0.0001620585"},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"lord","dir":"Articles","previous_headings":"Variations to the default options","what":"LORD","title":"Advanced usage of onlineFDR","text":"default version LORD used version ‘++’, user can optionally specify versions 3, ‘discard’ ‘dep’ using version argument (see details different versions). default w0=α/10w_0 = \\alpha/10 (LORD 3 LORD dep) b0=alpha−w0b0 = alpha - w0, parameters can optionally specified user subject requirements 0≤w0≤α0 \\leq w_0 \\leq \\alpha, b0>0b_0 > 0 w0+b0≤αw_0+b_0 \\leq \\alpha. value gammai also supplied default, can optionally specified user (described , see formula γj\\gamma_jhere version=‘dep’ versions LORD).","code":"set.seed(1); results.LORD.plus <- LORD(sample.df) set.seed(1); results.LORD3 <- LORD(sample.df, version=3) set.seed(1); results.LORD.discard <- LORD(sample.df, version='discard') set.seed(1); results.LORD.dep <- LORD(sample.df, version='dep')   # compare adjusted significance thresholds cbind(LORD.plus = results.LORD.plus$alphai,     LORD3 = results.LORD3$alphai,     LORD.discard  = results.LORD.discard$alphai,     LORD.dep = results.LORD.dep$alphai) #>          LORD.plus        LORD3 LORD.discard     LORD.dep #>  [1,] 0.0002675839 0.0002675839 0.0002675839 2.091542e-03 #>  [2,] 0.0024664457 0.0026615183 0.0011285264 1.002025e-02 #>  [3,] 0.0005732818 0.0005787961 0.0002823266 1.677763e-03 #>  [4,] 0.0004872805 0.0004929725 0.0002394680 6.262659e-04 #>  [5,] 0.0004059066 0.0004099744 0.0001998165 3.201787e-04 #>  [6,] 0.0003447286 0.0003475734 0.0001700069 1.933725e-04 #>  [7,] 0.0002986627 0.0003006772 0.0001475152 1.293954e-04 #>  [8,] 0.0029389397 0.0072216015 0.0014680343 1.548152e-04 #>  [9,] 0.0008168502 0.0015704700 0.0014680343 1.166482e-04 #> [10,] 0.0033835974 0.0091593329 0.0017451837 1.422614e-04 #> [11,] 0.0011873999 0.0019918653 0.0006438778 1.145119e-04 #> [12,] 0.0010225858 0.0016965126 0.0006438778 9.432408e-05 #> [13,] 0.0008785607 0.0014108836 0.0006438778 7.916885e-05 #> [14,] 0.0007679398 0.0011961369 0.0005497556 6.749313e-05 #> [15,] 0.0006820264 0.0010347488 0.0005497556 5.830055e-05"},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"saffron","dir":"Articles","previous_headings":"Variations to the default options","what":"SAFFRON","title":"Advanced usage of onlineFDR","text":"default w0=α/2w_0 = \\alpha/2 λ=0.5\\lambda = 0.5, parameters can optionally specified user subject requirements 0≤w0≤α0 \\leq w_0 \\leq \\alpha 0<λ<10 < \\lambda < 1. values gammai also supplied default, can optionally specified user (described , see formula γj\\gamma_jhere).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"addis","dir":"Articles","previous_headings":"Variations to the default options","what":"ADDIS","title":"Advanced usage of onlineFDR","text":"default w0=α/2w_0 = \\alpha/2, τ=0.5\\tau = 0.5 λ=0.25\\lambda = 0.25, parameters can optionally specified user subject requirements 0≤w0<α0 \\leq w_0 < \\alpha, 0<τ<10 < \\tau < 1 0<λ<τ0 < \\lambda < \\tau. values gammai also supplied default, can optionally specified user.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"alpha-spending-and-online-fallback","dir":"Articles","previous_headings":"Variations to the default options","what":"Alpha-spending and online fallback","title":"Advanced usage of onlineFDR","text":"values gammai supplied default, can optionally specified user.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"addis-spending","dir":"Articles","previous_headings":"Variations to the default options","what":"ADDIS-spending","title":"Advanced usage of onlineFDR","text":"default λ=0.25\\lambda = 0.25 τ=0.5\\tau = 0.5, parameters can optionally specified user subject requirements λ<τ\\lambda < \\tau, 0<λ<10 < \\lambda < 1 0<τ<10 < \\tau < 1. values gammai also supplied default, can optionally specified user.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/advanced-usage.html","id":"asynchronous-testing","dir":"Articles","previous_headings":"Variations to the default options","what":"Asynchronous testing","title":"Advanced usage of onlineFDR","text":"Zrnic et al. (2021) proposed procedures control modified FDR (mFDR) context asynchronous testing, .e. hypothesis test can sequential process tests can overlap time. presented asynchronous versions LOND, LORD SAFFRON procedures variety trial settings, including following: 1: Asynchronous online mFDR control: asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. 2: Online mFDR control local dependence: t>0t>0 allow p-value ptp_t arbitrary dependence previous LtL_t p-values. fixed sequence LtL_t referred `lags’. 3: mFDR control asynchronous mini-batch testing: mini-batch represents grouping tests run asynchronously result dependent p-values. mini-batch tests fully completed, new one can start, testing hypotheses independent previous batch.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"what-is-onlinefdr","dir":"Articles","previous_headings":"","what":"What is onlineFDR?","title":"Using the onlineFDR package","text":"Multiple hypothesis testing fundamental problem statistical inference, failure manage multiple testing problems highlighted one elements contributing replicability crisis science (Ioannidis 2015). Methodologies developed manage multiple testing situation adjusting significance levels family hypotheses, order control error metrics familywise error rate (FWER) false discovery rate (FDR). Frequently, modern data analysis problems complexity hypotheses arrive stream. introduces challenge step, investigator must decide whether reject current null hypothesis without access future p-values total number hypotheses tested, knowledge historic decisions date. onlineFDR package provides family algorithms can apply historic growing dataset control FDR FWER online manner. high-level, algorithms rely concept called “alpha wealth” experiments cost amount error “budget” discovery earns budget back. vignette explains two main uses package demonstrates typical workflows.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"which-algorithm-do-i-use","dir":"Articles","previous_headings":"","what":"Which algorithm do I use?","title":"Using the onlineFDR package","text":"strive make R package easy use possible. Please see flowchart decide function best solve problem. interactive version (click--functions) available .","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"frequently-asked-questions","dir":"Articles","previous_headings":"Which algorithm do I use?","what":"Frequently Asked Questions","title":"Using the onlineFDR package","text":"also provided non-exhaustive list answers questions may navigating flowchart. difference FDR FWER? FDR expected proportion false rejections rejections. FWER probability making false rejections . Controlling FWER conservative controlling FDR. Note case null hypotheses true, FDR FWER . different temporal structures mean? Offline refers case hypotheses tested simultaneously algorithm. Batch refers case hypotheses tested arrive batches. One--one refers case hypotheses tested arrive, one time. different data dependencies mean? ‘Independent’ means given null p-value depend non null p-values. simple way think p-values ‘positively dependent’ consider correlated hypothesis tests. instance, consider testing pairwise differences means 4 groups. group especially low mean, vs. B yield small p-value, also vs. C vs. D. Finally, ‘arbitrary dependence’ includes situation p-values happen correlated p-values long time ago. differences algorithms LOND, LORD, SAFFRON, ADDIS? LOND fairly simple algorithm significance levels multiplied number discoveries/rejections made thus far. also provably controls FDR p-values positively correlated. However, drawback unless many discoveries continually made right start online experiment, adjusted significance levels (hence power) quickly go towards zero. way, LOND oblivious information gained previous hypothesis tests take full advantage alpha-wealth. LORD improves upon LOND taking advantage “alpha investing” can regain alpha-wealth makes discovery/rejection. adjusted significance levels depend many discoveries made, also timing discoveries. However, one drawback LORD take advantage strength signals present data (.e. size p-values). SAFFRON improves upon focusing stronger signals experiment (.e. smaller p-values). removing possibility ever rejecting weaker signals (priori likely truly null hypotheses), SAFFRON preserves alpha-wealth. substantial fraction non-nulls online experiment, SAFFRON often powerful LORD. ADDIS improvement upon SAFFRON invests alpha-wealth effectively explicitly discarding weakest signals (.e. largest p-values) principled way. can result even higher power.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"general-info","dir":"Articles","previous_headings":"Quick Start","what":"General Info","title":"Using the onlineFDR package","text":"Quick Start guide meant provide framework use algorithms within onlineFDR package. algorithms used examples selected arbitrarily sake example.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"input-data","dir":"Articles","previous_headings":"Quick Start > General Info","what":"Input data","title":"Using the onlineFDR package","text":"general, dataset contain, minimum, column p-values (‘pval’)). can also pass id column (‘id’) date column (‘date’), optional; p-values treated ordered sequence. Alternatively, can also use just vector p-values, case, p-values also treated ordered sequence. using Batch algorithms, ensure dataset contains column (‘batch’) batches defined sequence starting 1. complex data structures, may want consider using STAR algorithms (see LONDstar(), LORDstar(), SAFFRONstar()). sure algorithm use, click . p-values generated passed function (just significant p-values). exception implemented orthogonal filter reduce dataset size, discussed (Burgon et al., 2010).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"what-happens-to-the-input-data","dir":"Articles","previous_headings":"Quick Start > General Info","what":"What happens to the input data","title":"Using the onlineFDR package","text":"’re using LOND(), LORD(), SAFFRON() ADDIS(), orders p-values date. multiple p-values date (.e. batch), order p-values within batch randomised default. Generally, users randomise unless priori knowledge hypotheses ordered way ones smaller p-values likely appear first. order randomisation p-values reproducible, necessary set seed (via set.seed function) calling wrapper function. Otherwise, algorithms take p-values original order data.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"understanding-the-output","dir":"Articles","previous_headings":"Quick Start > General Info","what":"Understanding the output","title":"Using the onlineFDR package","text":"hypothesis test, functions calculate adjusted significance thresholds (alphai) corresponding p-value declared statistically significant. Also calculated indicator function discoveries (R), R[] = 1 corresponds hypothesis rejected, otherwise R[] = 0. dataframe returned original data newly calculated alphai R.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"using-onlinefdr-exploratively","dir":"Articles","previous_headings":"Quick Start","what":"Using onlineFDR Exploratively","title":"Using the onlineFDR package","text":"package (corresponding Shiny app) can used exploratory way post-hoc. dataset p-values series experiments completed, can use algorithms provided onlineFDR explore control FDR different algorithms different levels power. First, initialize toy dataset three columns: identifier (‘id’), date (‘date’) p-value (‘pval’). Note date format “YYYY-MM-DD”. Next, call algorithm interest. Note also set seed using set.seed function order results reproducible. check many hypotheses ’ve rejected, can : compare results one algorithm another, can visualize adjusted significance thresholds:  Note LOND LORD result higher significance thresholds (alpha_i) Bonferroni adjustment. alphai jumps, indicates algorithm recovering “alpha wealth” makes discovery. can see algorithm discover anything time, alpha wealth decreases (alphai monotonically decrease), becomes harder reject null hypothesis since significance threshold gets smaller smaller.","code":"sample.df <- data.frame(   id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',          'C38292', 'A30619', 'D46627', 'E29198', 'A41418',          'D51456', 'C88669', 'E03673', 'A63155', 'B66033'),   date = as.Date(c(rep(\"2014-12-01\",3),                    rep(\"2015-09-21\",5),                    rep(\"2016-05-19\",2),                    \"2016-11-12\",                    rep(\"2017-03-27\",4))),   pval = c(2.90e-14, 0.00143, 0.06514, 0.00174, 0.00171,            3.61e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,            0.69274, 0.30443, 0.000487, 0.72342, 0.54757)) library(onlineFDR)  set.seed(1) LOND_results <- LOND(sample.df) LOND_results #>          pval       alphai R #> 1  2.9000e-14 0.0026758385 1 #> 2  1.4300e-03 0.0011638206 0 #> 3  6.5140e-02 0.0009912499 0 #> 4  1.7400e-03 0.0008243606 0 #> 5  1.7100e-03 0.0006988870 0 #> 6  2.7201e-01 0.0006045900 0 #> 7  3.6100e-05 0.0005319444 1 #> 8  7.9149e-01 0.0007117838 0 #> 9  7.5900e-08 0.0006421423 1 #> 10 2.8295e-01 0.0007796504 0 #> 11 6.9274e-01 0.0007155186 0 #> 12 7.2342e-01 0.0006610273 0 #> 13 3.0443e-01 0.0006141682 0 #> 14 5.4757e-01 0.0005734509 0 #> 15 4.8700e-04 0.0005377472 1 sum(LOND_results$R) #> [1] 4 set.seed(1) LORD_results <- LORD(sample.df)  set.seed(1) Bonf_results <- Alpha_spending(sample.df) # Bonferroni-like test  x <- seq_len(nrow(LOND_results)) par(mar=c(5.1, 4.1, 4.1, 9.1))  plot(x, log(LOND_results$alphai), ylim = c(-9.5, -2.5), type = 'l',      col = \"green\", xlab = \"Index\", ylab = \"log(alphai)\", panel.first = grid())  lines(x, log(LORD_results$alphai), col = \"blue\") # LORD lines(x, log(Bonf_results$alphai), col = \"red\") # Bonferroni-like test lines(x, rep(log(0.05),length(x)), col = \"purple\") # Unadjusted  legend(\"right\", legend = c(\"Unadjusted\", \"Bonferroni\", \"LORD\", \"LOND\"),        col = c(\"purple\", \"red\", \"blue\", \"green\"), lty = rep(1,4),        inset = c(-0.35,0), xpd = TRUE)"},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"using-onlinefdr-over-time","dir":"Articles","previous_headings":"Quick Start","what":"Using onlineFDR over time","title":"Using the onlineFDR package","text":"package can used time dataset grows. order randomisation data within previous batches remain (hence allow reproducibility results), seed used analyses. Ideally, selected algorithm priori based needs (click . can pass growing dataset algorithm.","code":"# Initial experimental data sample.df <- data.frame(   id = c('A15432', 'B90969', 'C18705'),   date = as.Date(c(rep(\"2014-12-01\",3))),   pval = c(2.90e-14, 0.06743, 0.01514))  set.seed(1) LOND_results <- LOND(sample.df) # After you've completed more experiments sample.df <- data.frame(   id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',          'C38292', 'A30619', 'D46627', 'E29198', 'A41418',          'D51456', 'C88669', 'E03673', 'A63155', 'B66033'),   date = as.Date(c(rep(\"2014-12-01\",3),                    rep(\"2015-09-21\",5),                    rep(\"2016-05-19\",2),                    \"2016-11-12\",                    rep(\"2017-03-27\",4))),   pval = c(2.90e-14, 0.06743, 0.01514, 0.08174, 0.00171,            3.61e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,            0.69274, 0.30443, 0.000487, 0.72342, 0.54757))  set.seed(1) LOND_results <- LOND(sample.df)"},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"more-advanced-use-cases","dir":"Articles","previous_headings":"Quick Start","what":"More Advanced Use Cases","title":"Using the onlineFDR package","text":"section covers use cases “advanced” onlineFDR users.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"batch-setting","dir":"Articles","previous_headings":"Quick Start > More Advanced Use Cases","what":"Batch Setting","title":"Using the onlineFDR package","text":"p-values came hypothesis tests performed batches, might consider using batch algorithms: BatchPRDS(), BatchBH(), BatchStBH().","code":"sample.df <- data.frame(   id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',          'C38292', 'A30619', 'D46627', 'E29198', 'A41418',          'D51456', 'C88669', 'E03673', 'A63155', 'B66033'),   pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,            3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,            0.69274, 0.30443, 0.00136, 0.72342, 0.54757),   batch = c(rep(1,5), rep(2,6), rep(3,4)))  batchprds_results <- BatchPRDS(sample.df)"},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"setting-a-bound","dir":"Articles","previous_headings":"Quick Start > More Advanced Use Cases","what":"Setting a Bound","title":"Using the onlineFDR package","text":"cases priori expect certain number hypothesis tests, can set bound. Note bounds LOND LORDdep depend alpha, ensure alpha value used bound alpha value used algorithm. Supply bound either betai gammai argument chosen algorithm.","code":"sample.df <- data.frame(   id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',          'C38292', 'A30619', 'D46627', 'E29198', 'A41418',          'D51456', 'C88669', 'E03673', 'A63155', 'B66033'),   date = as.Date(c(rep(\"2014-12-01\",3),                    rep(\"2015-09-21\",5),                    rep(\"2016-05-19\",2),                    \"2016-11-12\",                    rep(\"2017-03-27\",4))),   pval = c(2.90e-14, 0.06743, 0.01514, 0.08174, 0.00171,            3.61e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,            0.69274, 0.30443, 0.000487, 0.72342, 0.54757))  # Assuming a bound of 20 hypotheses bound <- setBound(\"LOND\", alpha = 0.04, 20)  set.seed(1) LOND_results <- LOND(sample.df, alpha = 0.04, betai = bound)"},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"online-fdr-control","dir":"Articles","previous_headings":"API","what":"Online FDR Control","title":"Using the onlineFDR package","text":"LOND() implements LOND procedure online FDR control, LOND stands (significance) Levels based Number Discoveries, presented Javanmard Montanari (2015). procedure controls FDR independent positively dependent (PRDS) p-values, option (dep = TRUE) guarantees control arbitrarily dependent p-values. LORD() implements LORD procedure online FDR control, LORD stands (significance) Levels based Recent Discovery, presented Javanmard Montanari (2018), Ramdas et al. (2017) Tian & Ramdas (2019). function provides different versions procedure valid independent p-values, see vignette(\"theory\"). also version (‘dep’) guarantees control dependent p-values. SAFFRON() implements SAFFRON procedure online FDR control, SAFFRON stands Serial estimate Alpha Fraction Futilely Rationed true Null hypotheses, presented Ramdas et al. (2018). procedure provides adaptive method online FDR control. Alpha_investing() Implements variant Alpha-investing algorithm Foster Stine (2008) guarantees FDR control, proposed Ramdas et al. (2018). procedure uses variant SAFFRON’s update rule. procedure controls FDR independent p-values. ADDIS() implements ADDIS algorithm online FDR control, ADDIS stands ADaptive algorithm DIScards conservative nulls, presented Tian & Ramdas (2019). algorithm compensates power loss SAFFRON conservative nulls, including adaptivity fraction null hypotheses (like SAFFRON) conservativeness nulls (unlike SAFFRON). procedure controls FDR independent p-values.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"batch-fdr-control","dir":"Articles","previous_headings":"API","what":"Batch FDR Control","title":"Using the onlineFDR package","text":"BatchPRDS() implements BatchPRDS algorithm online FDR control, PRDS stands positive regression dependency subset, presented Zrnic et al. (2020). BatchPRDS algorithm controls FDR p-values one batch positively dependent, independent across batches, running Benjamini-Hochberg procedure batch. BatchBH() implements BatchBH algorithm online FDR control, presented Zrnic et al. (2020). BatchBH algorithm controls FDR p-values batch independent, independent across batches, running Benjamini-Hochberg procedure batch. BatchStBH() implements BatchSt-BH algorithm online FDR control, presented Zrnic et al. (2020). algorithm makes one modification original Storey-BH algorithm (Storey 2002), adding 1 numerator null proportion estimate stable results. BatchSt-BH algorithm controls FDR p-values batch independent, independent across batches, running Storey Benjamini-Hochberg procedure batch.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"asynchronous-fdr-control","dir":"Articles","previous_headings":"API","what":"Asynchronous FDR Control","title":"Using the onlineFDR package","text":"LONDstar() implements LOND algorithm asynchronous online testing, presented Zrnic et al. (2021). controls mFDR. LORDstar() implements LORD algorithms asynchronous online testing, presented Zrnic et al. (2021). controls mFDR. SAFFRONstar() implements SAFFRON algorithm asynchronous online testing, presented Zrnic et al. (2021). controls mFDR.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"fwer-control","dir":"Articles","previous_headings":"API","what":"FWER Control","title":"Using the onlineFDR package","text":"Alpha_spending() implements online FWER control using Bonferroni-like test. Alpha-spending provides strong FWER control arbitrarily dependent p-values. online_fallback() implements online fallback algorithm FWER control, proposed Tian & Ramdas (2021). Online fallback uniformly powerful method Alpha-spending, saves significance level previous rejection. Online fallback strongly controls FWER arbitrarily dependent p-values. ADDIS_spending() implements ADDIS-spending algorithm online FWER control, proposed Tian & Ramdas (2021). algorithm compensates power loss Alpha-spending, including adaptivity fraction null hypotheses conservativeness nulls. ADDIS-spending provides strong FWER control independent p-values. Tian & Ramdas (2021) also presented version handling local dependence.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"how-to-get-help-for-onlinefdr","dir":"Articles","previous_headings":"","what":"How to get help for onlineFDR","title":"Using the onlineFDR package","text":"questions regarding onlineFDR posted Bioconductor support site, serves searchable knowledge base questions answers: https://support.bioconductor.org Posting question tagging “onlineFDR” automatically send alert package authors respond support site.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"acknowledgements","dir":"Articles","previous_headings":"","what":"Acknowledgements","title":"Using the onlineFDR package","text":"like thank IMPC team (via Jeremy Mason Hamed Haseli Mashhadi) useful discussions development package.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/onlineFDR.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Using the onlineFDR package","text":"Aharoni, E. Rosset, S. (2014). Generalized α\\alpha-investing: definitions, optimality results applications public databases. Journal Royal Statistical Society (Series B), 76(4):771–794. Benjamini, Y., Yekutieli, D. (2001). control false discovery rate multiple testing dependency. Annals Statistics, 29(4):1165-1188. Bourgon, R., Gentleman, R., Huber, W. (2010). Independent filtering increases detection power high-throughput experiments. Proceedings National Academy Sciences, 107(21), 9546-9551. Foster, D. Stine R. (2008). α\\alpha-investing: procedure sequential control expected false discoveries. Journal Royal Statistical Society (Series B), 29(4):429-444. Ioannidis, J.P.. (2005). published research findings false. PLoS Medicine, 2.8:e124. Javanmard, ., Montanari, . (2015). Online Control False Discovery Rate. arXiv preprint, https://arxiv.org/abs/1502.06197. Javanmard, ., Montanari, . (2018). Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Koscielny, G., et al. (2013). International Mouse Phenotyping Consortium Web Portal, unified point access knockout mice related phenotyping data. Nucleic Acids Research, 42.D1:D802-D809. Li, ., Barber, F.G. (2017). Accumulation Tests FDR Control Ordered Hypothesis Testing. Journal American Statistical Association, 112(518):837-849. Ramdas, ., Yang, F., Wainwright M.J. Jordan, M.. (2017). Online control false discovery rate decaying memory. Advances Neural Information Processing Systems 30, 5650-5659. Ramdas, ., Zrnic, T., Wainwright M.J. Jordan, M.. (2018). SAFFRON: adaptive algorithm online control false discovery rate. Proceedings 35th International Conference Machine Learning, 80:4286-4294. Robertson, D.S. Wason, J.M.S. (2018). Online control false discovery rate biomedical research. arXiv preprint, https://arxiv.org/abs/1809.07292. Robertson, D.S., Wason, J.M.S. Ramdas, . (2022). Online multiple hypothesis testing reproducible research. arXiv preprint, https://arxiv.org/abs/2208.11418. Robertson, D.S., Wildenhain, J., Javanmard, . Karp, N.. (2019). Online control false discovery rate biomedical research. Bioinformatics, 35:4196-4199, https://doi.org/10.1093/bioinformatics/btz191. Storey, J. D. (2002). direct approach false discovery rates. JRSS B, 64(3):479–498. Tian, J. Ramdas, . (2019). ADDIS: adaptive discarding algorithm online FDR control conservative nulls. Advances Neural Information Processing Systems, 32. Tian, J. Ramdas, . (2021). Online control familywise error rate. Statistical Methods Medical Research, 30(4):976–993. Zrnic, T., Jiang, D., Ramdas, . Jordan, M. (2020). power batching multiple hypothesis testing. International Conference Artificial Intelligence Statistics (AISTATS) 2020, PMLR, 108:3806-3815. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. JMLR, 22:1-33.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"fdr-control","dir":"Articles","previous_headings":"","what":"FDR Control","title":"The theory behind onlineFDR","text":"Consider sequence hypotheses H1,H2,H3,…H_1, H_2, H_3, \\ldots arrive sequentially stream, corresponding pp-values (p1,p2,p3,…)(p_1, p_2, p_3, \\ldots). testing procedure provides sequence adjusted significance thresholds αi\\alpha_i, corresponding decision rule: Ri={1if pi≤αi(reject Hi)0otherwise (accept Hi)} R_i = \\left\\{\\begin{array}{ccc} 1 & \\text{} p_i \\leq \\alpha_i & (\\text{reject } H_i)\\\\ 0 & \\text{otherwise } & (\\text{accept } H_i) \\end{array}\\right\\} online testing, significance thresholds can functions prior decisions, .e. αi=αi(R1,R2,…,Ri−1)\\alpha_i = \\alpha_i(R_1, R_2, \\ldots, R_{-1}). Javanmard Montanari (2015, 2018) proposed two procedures online control. first LOND, stands (significance) Levels based Number Discoveries. second LORD, stands (significance) Levels based Recent Discovery. LORD subsequently extended Ramdas et al. (2017). Ramdas et al. (2018) also proposed SAFFRON procedure, provides adaptive method online FDR control, includes variant Alpha-investing. Finally, Tian & Ramdas (2019) proposed ADDIS procedure improvement SAFFRON presence conservative nulls.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"LOND","dir":"Articles","previous_headings":"FDR Control","what":"LOND","title":"The theory behind onlineFDR","text":"LOND procedure controls FDR independent positively dependent (PRDS) pp-values. Given overall significance level α\\alpha, choose sequence non-negative numbers β=(βi)∈ℕ\\beta = (\\beta_i)_{\\\\mathbb{N}} sum α\\alpha. values adjusted significance thresholds αi\\alpha_i chosen follows: αi=βi(D(−1)+1) \\alpha_i = \\beta_i (D(-1) + 1)  D(n)=∑=1nRiD(n) = \\sum_{=1}^n R_i denotes number discoveries (.e. rejections) first nn hypotheses tested. LOND can adjusted also control FDR arbitrarily dependent pp-values. , modified β̃=βi/H()\\tilde{\\beta}_i = \\beta_i/H() place βi\\beta_i, H()=∑j=1i1jH() = \\sum_{j=1}^\\frac{1}{j} ii-th harmonic number. Note leads substantial loss power compared unadjusted LOND procedure. correction factor similar classical one used Benjamini Yekutieli (2001), except case ii-th hypothesis among NN penalised factor H()H() give consistent results across time (compared factor H(N)H(N) Benjamini Yekutieli method). default sequence β\\beta given βj=Cαlog(max(j,2))jelogj\\beta_j = C \\alpha \\frac{\\log(\\max(j, 2))}{j e^{\\sqrt{\\log j}}} C≈0.07720838C \\approx 0.07720838, proposed Javanmard Montanari (2018) equation 31.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"LORD","dir":"Articles","previous_headings":"FDR Control","what":"LORD","title":"The theory behind onlineFDR","text":"LORD procedure controls FDR independent pp-values. first fix sequence non-negative numbers γ=(γi)∈ℕ\\gamma = (\\gamma_i)_{\\\\mathbb{N}} γi≥γj\\gamma_i \\geq \\gamma_j ≤ji \\leq j ∑=1∞γi=1\\sum_{=1}^{\\infty} \\gamma_i = 1. time ii, let τi\\tau_i last time discovery made ii: τi=max{l∈{1,…,−1}:Rl=1} \\tau_i = \\max \\left\\{ l \\\\{1, \\ldots, -1\\} : R_l = 1\\right\\} LORD depends constants w0w_0 b0b_0, w0≥0w_0 \\geq 0 represents initial ‘wealth’ procedure b0>0b_0 > 0 represents ‘payout’ rejecting hypothesis. require w0+b0≤αw_0+b_0 \\leq \\alpha FDR control hold. Javanmard Montanari (2018) presented three different versions LORD, different definitions adjusted significance thresholds αi\\alpha_i. Versions 1 2 since superseded LORD++ procedure Ramdas et al. (2017), describe . LORD++: significance thresholds LORD++ chosen follows: αi=γiw0+(α−w0)γi−τ1+α∑j:τj<,τj≠τ1γi−τj \\alpha_i = \\gamma_i w_0 + (\\alpha - w_0) \\gamma_{-\\tau_1} + \\alpha \\sum_{j : \\tau_j < , \\tau_j \\neq \\tau_1} \\gamma_{- \\tau_j} LORD 3: significance thresholds depend time last discovery time wealth accumulated time, αi=γi−τiW(τi) \\alpha_i  = \\gamma_{- \\tau_i} W(\\tau_i)  τ1=0\\tau_1 = 0. {W(j)}j≥0\\{W(j)\\}_{j \\geq 0} represents ‘wealth’ available time jj, defined recursively: W(0)=w0W(j)=W(j−1)−αj−1+b0Rj \\begin{aligned} W(0) &= w_0 \\\\ W(j) &= W(j-1) - \\alpha_{j-1} + b_0 R_j \\end{aligned} D-LORD: equivalent LORD++ procedure discarding. Given discarding threshold τ∈(0,1)\\tau \\(0,1) initial wealth w0≤ταw_0 \\leq \\tau\\alpha significance thresholds chosen follows: αt=min{τ,α̃t} \\alpha_t = \\min\\{\\tau, \\tilde{\\alpha}_t\\}  α̃t=w0γSt+(τα−w0)γSt−κ1*+τα∑j≥2γSt−κj* \\tilde{\\alpha}_t = w_0 \\gamma_{S^t} + (\\tau\\alpha - w_0)\\gamma_{S^t - \\kappa_1^*} + \\tau\\alpha \\sum_{j \\geq 2} \\gamma_{S^t - \\kappa_j^*}  κj=min{∈[t−1]:∑k≤i1{pk≤αk}≥j},κj*=∑≤κj1{pi≤τ},St=∑<t1{pi≤τ} \\kappa_j = \\min\\{\\[t-1] : \\sum_{k \\leq } 1 \\{p_k \\leq \\alpha_k\\} \\geq j\\}, \\; \\kappa_j^* = \\sum_{\\leq \\kappa_j} 1 \\{p_i \\leq \\tau \\}, \\; S^t = \\sum_{< t} 1 \\{p_i \\leq \\tau \\} LORD++ instance monotone rule, provably controls FDR independent p-values provided w0≤αw_0 \\leq \\alpha. LORD 3 non-monotone rule, FDR control demonstrated empirically. scenarios large NN, LORD 3 slightly higher power LORD++ (see Robertson et al., 2018), since non-monotone rule recommend using LORD++ (default), especially since also provable guarantee FDR control. versions, default sequence γ\\gamma given γj=Clog(max(j,2))jelogj\\gamma_j = C \\frac{\\log(\\max(j, 2))}{j e^{\\sqrt{\\log j}}} C≈0.07720838C \\approx 0.07720838, proposed Javanmard Montanari (2018) equation 31. Javanmard Montanari (2018) also proposed adjusted version LORD valid arbitrarily dependent p-values. Similarly LORD 3, adjusted significance thresholds set equal αi=ξiW(τi) \\alpha_i = \\xi_i W(\\tau_i) (assuming w0≤b0w_0 \\leq b_0), ∑j=1∞ξi(1+log(j))≤α/b0\\sum_{j=1}^{\\infty} \\xi_i (1 + \\log(j)) \\leq \\alpha / b_0 default sequence ξ\\xi given ξj=Cαb0jlog(max(j,2))3 \\xi_j  = \\frac{C \\alpha }{b_0 j \\log(\\max(j, 2))^3} C≈0.139307C \\approx 0.139307. Note allowing dependent p-values can lead substantial loss power compared LORD procedures described .","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"SAFFRON","dir":"Articles","previous_headings":"FDR Control","what":"SAFFRON","title":"The theory behind onlineFDR","text":"SAFFRON procedure controls FDR independent p-values, proposed Ramdas et al. (2018). algorithm based estimate proportion true null hypotheses. precisely, SAFFRON sets adjusted test levels based estimate amount alpha-wealth allocated testing true null hypotheses. SAFFRON depends constants w0w_0 λ\\lambda, w0w_0 satisfies 0≤w0≤α0 \\leq w_0 \\leq \\alpha represents initial ‘wealth’ procedure, λ∈(0,1)\\lambda \\(0,1) represents threshold ‘candidate’ hypothesis. ‘candidate’ refers p-values smaller λ\\lambda, since SAFFRON never reject p-value larger λ\\lambda. candidates can thought hypotheses -priori likely non-null. SAFFRON procedure runs follows: time tt, define number candidates jj-th rejection Cj+=Cj+(t)=∑=τj+1t−1Ci C_{j+} = C_{j+}(t) = \\sum_{= \\tau_j + 1}^{t-1} C_i Ct=1{pt≤λ}C_t = 1\\{p_t \\leq \\lambda \\} indicator candidacy. SAFFRON starts α1=min{(1−λ)γ1w0,λ}\\alpha_1 = \\min\\{(1 - \\lambda)\\gamma_1 w_0, \\lambda\\}. Subsequent test levels chosen αt=min{λ,α̃t}\\alpha_t = \\min\\{ \\lambda, \\tilde{\\alpha}_t\\}, α̃t=(1−λ)[w0γt−C0++(α−w0)γt−τ1−C1++α∑j≥2γt−τj−Cj+] \\tilde{\\alpha}_t = (1 - \\lambda) [w_0 \\gamma_{t-C_{0+}} + (\\alpha - w_0)\\gamma_{t-\\tau_1-C_{1+}} + \\alpha \\sum_{j \\geq 2} \\gamma_{t - \\tau_j- C_{j+}}] default sequence γ\\gamma SAFFRON given γj∝j−1.6\\gamma_j \\propto j^{-1.6}.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"AlphaInvesting","dir":"Articles","previous_headings":"FDR Control","what":"Alpha-investing","title":"The theory behind onlineFDR","text":"Ramdas et al. (2018) proposed variant Alpha-investing algorithm Foster Stine (2008) guarantees FDR control independent p-values. procedure uses SAFFRON’s update rule constant λ\\lambda replaced sequence λi=αi\\lambda_i = \\alpha_i. also equivalent using ADDIS algorithm (see ) τ=1\\tau = 1 λi=αi\\lambda_i = \\alpha_i.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"ADDIS","dir":"Articles","previous_headings":"FDR Control","what":"ADDIS","title":"The theory behind onlineFDR","text":"ADDIS procedure controls FDR independent p-values, proposed Tian & Ramdas (2019). algorithm compensates power loss SAFFRON conservative nulls, including adaptivity fraction null hypotheses (like SAFFRON) conservativeness nulls (unlike SAFFRON). ADDIS depends constants w0,λw_0, \\lambda τ\\tau. w0w_0 represents initial `wealth’ procedure satisfies 0≤w0≤α0 \\leq w_0 \\leq \\alpha. τ∈(0,1]\\tau \\(0,1] represents threshold hypothesis selected testing: p-values greater τ\\tau implicitly ‘discarded’ procedure. Finally, λ∈[0,τ)\\lambda \\[0,\\tau) sets threshold p-value candidate rejection: ADDIS never reject p-value larger λ\\lambda. significance thresholds ADDIS chosen follows: αt=min{λ,α̃t} \\alpha_t = \\min\\{\\lambda, \\tilde{\\alpha}_t\\}  α̃t=(τ−λ)[w0γSt−C0++(α−w0)γSt−κ1*−C1++α∑j≥2γSt−κj*−Cj+ \\tilde{\\alpha}_t = (\\tau - \\lambda)[w_0 \\gamma_{S^t-C_{0+}} +  (\\alpha - w_0)\\gamma_{S^t - \\kappa_1^*-C_{1+}} + \\alpha \\sum_{j \\geq 2} \\gamma_{S^t - \\kappa_j^* - C_{j+}}  κj=min{∈[t−1]:∑k≤i1{pk≤αk}≥j},κj*=∑≤κj1{pi≤τ},St=∑<t1{pi≤τ},Cj+=∑=κj+1t−11{pi≤λ} \\kappa_j = \\min\\{\\[t-1] : \\sum_{k \\leq } 1 \\{p_k \\leq \\alpha_k\\} \\geq j\\}, \\; \\kappa_j^* = \\sum_{\\leq \\kappa_j} 1 \\{p_i \\leq \\tau \\}, \\; S^t = \\sum_{< t} 1 \\{p_i \\leq \\tau \\}, \\; C_{j+} = \\sum_{= \\kappa_j + 1}^{t-1} 1\\{p_i \\leq \\lambda\\} default sequence γ\\gamma ADDIS SAFFRON given .","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"Alpha-spending","dir":"Articles","previous_headings":"FWER Control","what":"Alpha-spending","title":"The theory behind onlineFDR","text":"Alpha-spending procedure controls FWER potentially infinite stream p-values using Bonferroni-like test. Given overall significance level α\\alpha, significance thresholds chosen αi=αγi\\alpha_i = \\alpha \\gamma_i ∑=1∞γi=1\\sum_{=1}^{\\infty} \\gamma_i = 1 γi≥0\\gamma_i \\geq 0. procedure strongly controls FWER arbitrarily dependent p-values. Note procedure also controls generalised familywise error rate (k-FWER) k>1k > 1 α\\alpha replaced min(1,kα)\\min(1,k\\alpha). default sequence γ\\gamma ξ\\xi LORD given .","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"onlineFallback","dir":"Articles","previous_headings":"FWER Control","what":"Online Fallback","title":"The theory behind onlineFDR","text":"online fallback procedure Tian & Ramdas (2019b) provides uniformly powerful method Alpha-spending, saving significance level previous rejection. specifically, online fallback tests hypothesis HiH_i level αi=αγi+Ri−1αi−1\\alpha_i = \\alpha \\gamma_i + R_{-1} \\alpha_{-1} Ri=1{pi≤αi}R_i = 1\\{p_i \\leq \\alpha_i\\} denotes rejected hypothesis. procedure strongly controls FWER arbitrarily dependent p-values. default sequence γ\\gamma ξ\\xi LORD given .","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"ADDIS-spending","dir":"Articles","previous_headings":"FWER Control","what":"ADDIS-spending","title":"The theory behind onlineFDR","text":"ADDIS-spending procedure strongly controls FWER independent p-values, proposed Tian & Ramdas (2021). procedure compensates power loss Alpha-spending, including adapativity fraction null hypotheses conservativeness nulls. ADDIS depends constants λ\\lambda τ\\tau, λ<τ\\lambda < \\tau. τ∈(0,1)\\tau \\(0,1) represents threshold hypothesis selected testing: p-values greater τ\\tau implicitly `discarded’ procedure, λ∈(0,1)\\lambda \\(0,1) sets threshold p-value candidate rejection: ADDIS-spending never reject p-value larger λ\\lambda. Note procedure controls generalised familywise error rate (k-FWER) k>1k > 1 α\\alpha replaced min(1,kα)\\min(1,k\\alpha). Tian Ramdas (2019b) also presented version handling local dependence, see Section Asynchronous testing . default sequence γ\\gamma ADDIS-spending SAFFRON given .","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/articles/theory.html","id":"accounting-for-dependent-p-values","dir":"Articles","previous_headings":"","what":"Accounting for dependent p-values","title":"The theory behind onlineFDR","text":"noted , LORD, SAFFRON, ADDIS ADDIS-spending procedures assume independent p-values, LOND procedure also valid positive dependencies (like Benjamini-Hochberg method, see ). Adjusted versions LOND LORD available arbitrarily dependent p-values. Alpha-spending online fallback also control FWER FDR arbitrarily dependent p-values. way comparison, usual Benjamini-Hochberg method controlling FDR assumes p-values positively dependent (PRDS). example, PRDS satisfied multivariate normal test statistics positive correlation matrix). See Benjamini & Yekutieli (2001) technical details.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David S. Robertson. Author, maintainer. Lathan Liou. Author. Aaditya Ramdas. Author. Adel Javanmard. Contributor. Andrea Montanari. Contributor. Jinjin Tian. Contributor. Tijana Zrnic. Contributor. Natasha . Karp. Author. Nikita Mozgunov. Contributor.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Robertson DS, Liou L, Ramdas , Javanmard , Montanari , Tian J, Zrnic T, Karp NA, Mozgunov N (2025). onlineFDR: Online error rate control. R package version 2.19.1, <URL: https://doi.org/doi:10.18129/B9.bioc.onlineFDR>. Robertson DS, Wildenhain J, Javanmard , Karp NA (2019). 'onlineFDR: R package control false discovery rate growing data repositories.' Bioinformatics, 35:4196-4199. doi: 10.1093/bioinformatics/btz191","code":"@Manual{,   title = {onlineFDR: Online Error Rate Control},   author = {David S. Robertson and Lathan Liou and Aaditya Ramdas and Adel Javanmard and Andrea Montanari and Jinjin Tian and Tijana Zrnic and Natasha A. Karp and Nikita Mozgunov},   year = {2025},   note = {R package version 2.19.1},   url = {https://doi.org/doi:10.18129/B9.bioc.onlineFDR}, } @Article{,   title = {onlineFDR: an R package to control the false discovery rate for growing data repositories},   author = {David S. Robertson and Jan Wildenhain and Adel Javanmard and Natasha A. Karp},   journal = {Bioinformatics},   year = {2019},   volume = {35},   pages = {4196-4199},   doi = {10.1093/bioinformatics/btz191}, }"},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"onlinefdr-","dir":"","previous_headings":"","what":"Online Error Rate Control","title":"Online Error Rate Control","text":"onlineFDR allows users control false discovery rate (FDR) familywise error rate (FWER) online hypothesis testing, hypotheses arrive stream. framework, null hypothesis rejected based evidence previous rejection decisions.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Online Error Rate Control","text":"can install onlineFDR Bioconductor (release devel) GitHub:","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"bioconductor-release","dir":"","previous_headings":"Installation","what":"Bioconductor (release)","title":"Online Error Rate Control","text":"","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(\"onlineFDR\")"},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"bioconductor-devel","dir":"","previous_headings":"Installation","what":"Bioconductor (devel)","title":"Online Error Rate Control","text":"","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(version = \"devel\") BiocManager::install(\"onlineFDR\")"},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"github-development-snapshot","dir":"","previous_headings":"Installation","what":"GitHub (development snapshot)","title":"Online Error Rate Control","text":"","code":"# install.packages(\"devtools\") # If devtools not installed  devtools::install_github(\"dsrobertson/onlineFDR\")"},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Online Error Rate Control","text":"Documentation hosted https://dsrobertson.github.io/onlineFDR/ view vignette version package installed system, start R enter:","code":"browseVignettes(\"onlineFDR\")"},{"path":"https://dsrobertson.github.io/onlineFDR/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Online Error Rate Control","text":"Aharoni, E. Rosset, S. (2014). Generalized alpha-investing: definitions, optimality results applications public databases. Journal Royal Statistical Society (Series B), 76(4):771–794. Foster, D. Stine R. (2008). alpha-investing: procedure sequential control expected false discoveries. Journal Royal Statistical Society (Series B), 29(4):429-444. Javanmard, ., Montanari, . (2015). Online Control False Discovery Rate. arXiv preprint, https://arxiv.org/abs/1502.06197. Javanmard, ., Montanari, . (2018). Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Ramdas, ., Yang, F., Wainwright M.J. Jordan, M.. (2017). Online control false discovery rate decaying memory. Advances Neural Information Processing Systems 30, 5650-5659. Ramdas, ., Zrnic, T., Wainwright M.J. Jordan, M.. (2018). SAFFRON: adaptive algorithm online control false discovery rate. Proceedings 35th International Conference Machine Learning, 80:4286-4294. Robertson, D.S. Wason, J.M.S. (2018). Online control false discovery rate biomedical research. arXiv preprint, https://arxiv.org/abs/1809.07292. Robertson, D.S., Wason, J.M.S. Ramdas, . (2022). Online multiple hypothesis testing reproducible research. arXiv preprint, https://arxiv.org/abs/2208.11418. Robertson, D.S., Wildenhain, J., Javanmard, . Karp, N.. (2019). onlineFDR: R package control false discovery rate growing data repositories. Bioinformatics, 35:4196-4199, https://doi.org/10.1093/bioinformatics/btz191. Tian, J. Ramdas, . (2019). ADDIS: adaptive discarding algorithm online FDR control conservative nulls. Advances Neural Information Processing Systems, 9388-9396. Tian, J. Ramdas, . (2021). Online control familywise error rate. Statistical Methods Medical Research, 30(4):976–993. Zrnic, T., Jiang D., Ramdas . Jordan M. (2020). Power Batching Multiple Hypothesis Testing. International Conference Artificial Intelligence Statistics, PMLR, 108:3806-3815. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research, 22:1-33.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":null,"dir":"Reference","previous_headings":"","what":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"Implements ADDIS algorithm online FDR control, ADDIS stands ADaptive algorithm DIScards conservative nulls, presented Tian Ramdas (2019). algorithm compensates power loss SAFFRON conservative nulls, including adaptivity fraction null hypotheses (like SAFFRON) conservativeness nulls (unlike SAFFRON).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"","code":"ADDIS(   d,   alpha = 0.05,   gammai,   w0,   lambda = 0.25,   tau = 0.5,   async = FALSE,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"d Either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), decision times (`decision.times'). alpha Overall significance level procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). w0 Initial `wealth' procedure, defaults \\(\\alpha/2\\). lambda Optional parameter sets threshold `candidate' hypotheses. Must 0 tau, defaults 0.25. tau Optional threshold hypotheses selected testing. Must 0 1, defaults 0.5. async Logical. TRUE runs version asynchronous testing process. Defaults FALSE. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. needed async=FALSE. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"dataframe original p-values pval,   adjusted testing levels \\(\\alpha_i\\) indicator function   discoveries R. Hypothesis \\(\\) rejected \\(\\)-th   p-value less equal \\(\\alpha_i\\), case R[] =   1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"function takes input either vector p-values, dataframe three columns. dataframe requires identifier (`id'), date (`date') p-value (`pval'). asynchronous version specified (see ), column date replaced decision times. Given overall significance level \\(\\alpha\\), ADDIS depends constants \\(w_0\\), \\(\\lambda\\) \\(\\tau\\). \\(w_0\\) represents initial `wealth' procedure satisfies \\(0 \\le w_0 \\le \\alpha\\). \\(\\tau \\(0,1)\\) represents threshold hypothesis selected testing: p-values greater \\(\\tau\\) implicitly `discarded' procedure. Finally, \\(\\lambda \\[0,\\tau)\\) sets threshold p-value candidate rejection: ADDIS never reject p-value larger \\(\\lambda\\). algorithm also require sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. ADDIS procedure provably controls FDR independent p-values. Tian Ramdas (2019) also presented version asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. decision times given input decision.times. Note asynchronous version controls modified version FDR. details ADDIS algorithms can found Tian Ramdas (2019).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"Tian, J. Ramdas, . (2019). ADDIS: adaptive discarding   algorithm online FDR control conservative nulls.   Advances Neural Information Processing Systems, 9388-9396.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS","text":"","code":"sample.df1 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                 rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                 rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  ADDIS(sample.df1, random=FALSE) #>          pval      alphai R     id #> 1  2.9000e-08 0.002734314 1 A15432 #> 2  6.7430e-02 0.005468627 0 B90969 #> 3  1.5140e-02 0.005468627 0 C18705 #> 4  8.1740e-02 0.005468627 0 B49731 #> 5  1.7100e-03 0.005468627 1 E99902 #> 6  3.6000e-05 0.010937254 1 C38292 #> 7  7.9149e-01 0.016405881 0 A30619 #> 8  2.7201e-01 0.016405881 0 D46627 #> 9  2.8295e-01 0.005411923 0 E29198 #> 10 7.5900e-08 0.002828822 1 A41418 #> 11 6.9274e-01 0.008297449 0 D51456 #> 12 3.0443e-01 0.008297449 0 C88669 #> 13 1.3600e-03 0.003589243 1 E03673 #> 14 7.2342e-01 0.009057870 0 A63155 #> 15 5.4757e-01 0.009057870 0 B66033   sample.df2 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), decision.times = seq_len(15) + 1)  ADDIS(sample.df2, async = TRUE) # Asynchronous #>          pval       alphai R     id #> 1  2.9000e-08 0.0027343135 1 A15432 #> 2  6.7430e-02 0.0009019871 0 B90969 #> 3  1.5140e-02 0.0018039742 0 C18705 #> 4  8.1740e-02 0.0018039742 0 B49731 #> 5  1.7100e-03 0.0018039742 1 E99902 #> 6  3.6000e-05 0.0018039742 1 C38292 #> 7  7.9149e-01 0.0036079483 0 A30619 #> 8  2.7201e-01 0.0054119225 0 D46627 #> 9  2.8295e-01 0.0054119225 0 E29198 #> 10 7.5900e-08 0.0028288216 1 A41418 #> 11 6.9274e-01 0.0017852686 0 D51456 #> 12 3.0443e-01 0.0035892428 0 C88669 #> 13 1.3600e-03 0.0035892428 1 E03673 #> 14 7.2342e-01 0.0021921853 0 A63155 #> 15 5.4757e-01 0.0039961595 0 B66033"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":null,"dir":"Reference","previous_headings":"","what":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"Implements exhaustive variant ADDIS algorithm online FDR control adapting code Fischer, L.: Exhaustive ADDIS procedures online FWER control.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"","code":"ADDIS_exhaustive(d, alpha = 0.05, tau = 0.5, lambda = 0.25, gamma = NULL)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"d Either vector p-values, dataframe least `pval` column (optionally `id`). alpha Overall significance level procedure, default 0.05. tau Optional threshold hypotheses selected testing. Must 0 1, defaults 0.5. lambda Optional parameter sets threshold `candidate' hypotheses. Must 0 tau, defaults 0.25. gamma Optional vector initial weights. `NULL` (default), decreasing sequence proportional j^(-1.6) used, ADDIS().","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"dataframe original p-values `pval`, per-hypothesis   testing levels `alphai`, indicator discoveries `R`.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"Fischer, L.: Exhaustive ADDIS procedures online FWER control.   arXiv:2308.13827 <https://arxiv.org/abs/2308.13827>","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_exhaustive.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ADDIS_exhaustive: Exhaustive ADDIS procedure for online FDR control — ADDIS_exhaustive","text":"Lasse Fischer","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":null,"dir":"Reference","previous_headings":"","what":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"Implements ADDIS algorithm online FWER control, ADDIS stands ADaptive algorithm DIScards conservative nulls, presented Tian Ramdas (2021). procedure compensates power loss Alpha-spending, including adaptivity fraction null hypotheses conservativeness nulls.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"","code":"ADDIS_spending(   d,   alpha = 0.05,   gammai,   lambda = 0.25,   tau = 0.5,   dep = FALSE,   display_progress = FALSE )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"d Either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), lags (`lags'). alpha Overall significance level procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). lambda Optional parameter sets threshold `candidate' hypotheses. Must 0 1, defaults 0.25. tau Optional threshold hypotheses selected testing. Must 0 1, defaults 0.5. dep Logical. TRUE runs version locally dependent p-values display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"dataframe original p-values pval,   adjusted testing levels \\(\\alpha_i\\) indicator function   discoveries R. Hypothesis \\(\\) rejected \\(\\)-th   p-value less equal \\(\\alpha_i\\), case R[] =   1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), lags, dependent version specified (see ). Given overall significance level \\(\\alpha\\), ADDIS depends constants \\(\\lambda\\) \\(\\tau\\), \\(\\lambda < \\tau\\). \\(\\tau \\(0,1)\\) represents threshold hypothesis selected testing: p-values greater \\(\\tau\\) implicitly `discarded' procedure, \\(\\lambda \\(0,1)\\) sets threshold p-value candidate rejection: ADDIS-spending never reject p-value larger \\(\\lambda\\). algorithms also require sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. ADDIS-spending procedure provably controls FWER strong sense independent p-values. Note procedure also controls generalised familywise error rate (k-FWER) \\(k > 1\\) \\(\\alpha\\) replaced min(\\(1, k\\alpha\\)). Tian Ramdas (2021) also presented version handling local dependence. precisely, \\(t>0\\) allow p-value \\(p_t\\) arbitrary dependence previous \\(L_t\\) p-values. fixed sequence \\(L_t\\) referred `lags', given input lags version ADDIS-spending algorithm. details ADDIS-spending algorithms can found Tian Ramdas (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"Tian, J. Ramdas, . (2021). Online control familywise   error rate. Statistical Methods Medical Research 30(4):976–993.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/ADDIS_spending.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), lags = rep(1,15))  ADDIS_spending(sample.df) #independent #>          pval       alphai R #> 1  2.9000e-08 0.0054686271 1 #> 2  6.7430e-02 0.0054686271 0 #> 3  1.5140e-02 0.0054686271 0 #> 4  8.1740e-02 0.0054686271 0 #> 5  1.7100e-03 0.0054686271 1 #> 6  3.6000e-05 0.0054686271 1 #> 7  7.9149e-01 0.0054686271 0 #> 8  2.7201e-01 0.0054686271 0 #> 9  2.8295e-01 0.0018039742 0 #> 10 7.5900e-08 0.0009429405 1 #> 11 6.9274e-01 0.0009429405 0 #> 12 3.0443e-01 0.0009429405 0 #> 13 1.3600e-03 0.0005950895 0 #> 14 7.2342e-01 0.0005950895 0 #> 15 5.4757e-01 0.0005950895 0  ADDIS_spending(sample.df, dep = TRUE) #Locally dependent #>          pval       alphai R #> 1  2.9000e-08 0.0054686271 1 #> 2  6.7430e-02 0.0018039742 0 #> 3  1.5140e-02 0.0018039742 0 #> 4  8.1740e-02 0.0018039742 0 #> 5  1.7100e-03 0.0018039742 1 #> 6  3.6000e-05 0.0018039742 1 #> 7  7.9149e-01 0.0018039742 0 #> 8  2.7201e-01 0.0018039742 0 #> 9  2.8295e-01 0.0009429405 0 #> 10 7.5900e-08 0.0005950895 1 #> 11 6.9274e-01 0.0005950895 0 #> 12 3.0443e-01 0.0005950895 0 #> 13 1.3600e-03 0.0004164149 0 #> 14 7.2342e-01 0.0004164149 0 #> 15 5.4757e-01 0.0004164149 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha-investing for online FDR control — Alpha_investing","title":"Alpha-investing for online FDR control — Alpha_investing","text":"Implements variant Alpha-investing algorithm Foster Stine (2008) guarantees FDR control, proposed Ramdas et al. (2018). procedure uses SAFFRON's update rule constant \\(\\lambda\\) replaced sequence \\(\\lambda_i = \\alpha_i\\). also equivalent using ADDIS algorithm \\(\\tau = 1\\) \\(\\lambda_i = \\alpha_i\\).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha-investing for online FDR control — Alpha_investing","text":"","code":"Alpha_investing(   d,   alpha = 0.05,   gammai,   w0,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha-investing for online FDR control — Alpha_investing","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence. alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). w0 Initial `wealth' procedure, defaults \\(\\alpha/2\\). Must 0 \\(\\alpha\\). random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alpha-investing for online FDR control — Alpha_investing","text":"dataframe original data d (  reordered batches random = TRUE),   LORD-adjusted significance thresholds \\(\\alpha_i\\) indicator   function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\(\\alpha_i\\), case   R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alpha-investing for online FDR control — Alpha_investing","text":"function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence. Alpha-investing procedure provably controls FDR independent p-values. Given overall significance level \\(\\alpha\\), choose sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. Alpha-investing depends constant \\(w_0\\), satisfies \\(0 \\le w_0 \\le \\alpha\\) represents initial `wealth' procedure. details Alpha-investing procedure modification can found Foster Stine (2008) Ramdas et al. (2018).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alpha-investing for online FDR control — Alpha_investing","text":"Foster, D. Stine R. (2008). \\(\\alpha\\)-investing:   procedure sequential control expected false discoveries.   Journal Royal Statistical Society (Series B), 29(4):429-444. Ramdas, ., Zrnic, T., Wainwright M.J. Jordan, M.. (2018). SAFFRON:   adaptive algorithm online control false discovery rate.   Proceedings 35th International Conference Machine   Learning, 80:4286-4294.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_investing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alpha-investing for online FDR control — Alpha_investing","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  Alpha_investing(sample.df, random=FALSE) #>          pval      alphai R #> 1  2.9000e-08 0.010818925 1 #> 2  6.7430e-02 0.021406257 0 #> 3  1.5140e-02 0.007164201 0 #> 4  8.1740e-02 0.003757589 0 #> 5  1.7100e-03 0.002374706 1 #> 6  3.6000e-05 0.023680499 1 #> 7  7.9149e-01 0.044095287 0 #> 8  2.7201e-01 0.015842430 0 #> 9  2.8295e-01 0.008711190 0 #> 10 7.5900e-08 0.005700295 1 #> 11 6.9274e-01 0.026865786 0 #> 12 3.0443e-01 0.011205456 0 #> 13 1.3600e-03 0.006863124 1 #> 14 7.2342e-01 0.027979664 0 #> 15 5.4757e-01 0.011945806 0  set.seed(1); Alpha_investing(sample.df) #>          pval      alphai R #> 1  2.9000e-08 0.010818925 1 #> 2  6.7430e-02 0.021406257 0 #> 3  1.5140e-02 0.007164201 0 #> 4  8.1740e-02 0.003757589 0 #> 5  1.7100e-03 0.002374706 1 #> 6  2.7201e-01 0.023680499 0 #> 7  3.6000e-05 0.008803369 1 #> 8  7.9149e-01 0.029838354 0 #> 9  7.5900e-08 0.012084065 1 #> 10 2.8295e-01 0.032981505 0 #> 11 6.9274e-01 0.014137539 0 #> 12 7.2342e-01 0.008529625 0 #> 13 3.0443e-01 0.005905508 0 #> 14 5.4757e-01 0.004412045 0 #> 15 1.3600e-03 0.003461425 1  set.seed(1); Alpha_investing(sample.df, alpha=0.1, w0=0.025) #>          pval      alphai R #> 1  2.9000e-08 0.010818925 1 #> 2  6.7430e-02 0.041915265 0 #> 3  1.5140e-02 0.014226480 0 #> 4  8.1740e-02 0.007487045 0 #> 5  1.7100e-03 0.004738159 1 #> 6  2.7201e-01 0.046265410 0 #> 7  3.6000e-05 0.017453092 1 #> 8  7.9149e-01 0.057947646 0 #> 9  7.5900e-08 0.023879569 1 #> 10 2.8295e-01 0.063856912 0 #> 11 6.9274e-01 0.027880910 0 #> 12 7.2342e-01 0.016914972 0 #> 13 3.0443e-01 0.011741675 0 #> 14 5.4757e-01 0.008785330 0 #> 15 1.3600e-03 0.006898971 1"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":null,"dir":"Reference","previous_headings":"","what":"Alpha-spending for online FWER control — Alpha_spending","title":"Alpha-spending for online FWER control — Alpha_spending","text":"Implements online FWER control using Bonferroni-like test.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alpha-spending for online FWER control — Alpha_spending","text":"","code":"Alpha_spending(   d,   alpha = 0.05,   gammai,   random = TRUE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alpha-spending for online FWER control — Alpha_spending","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\), hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha \\gamma_i\\). default provided proposed Javanmard Montanari (2018), equation 31. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alpha-spending for online FWER control — Alpha_spending","text":"dataframe original data d ( reordered batches random = TRUE), adjusted  signifcance thresholds alphai indicator function  discoveries R, R[] = 1 corresponds hypothesis  \\(\\) rejected (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alpha-spending for online FWER control — Alpha_spending","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. Alpha-spending provides strong FWER control potentially infinite stream p-values using Bonferroni-like test. Given overall significance level \\(\\alpha\\), choose (potentially infinite) sequence non-negative numbers \\(\\gamma_i\\) sum 1. Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha \\gamma_i\\). Note procedure controls generalised familywise error rate (k-FWER) \\(k > 1\\) \\(\\alpha\\) replaced min(\\(1, k\\alpha\\)).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alpha-spending for online FWER control — Alpha_spending","text":"Javanmard, . Montanari, . (2018) Online Rules Control  False Discovery Rate False Discovery Exceedance. Annals  Statistics, 46(2):526-554. Tian, J. Ramdas, . (2021). Online control familywise error rate. Statistical Methods Medical Research (appear), https://arxiv.org/abs/1910.04900.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/Alpha_spending.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alpha-spending for online FWER control — Alpha_spending","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                 rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                 rep('2017-03-27',4))), pval = c(2.90e-17, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  set.seed(1); Alpha_spending(sample.df) #>        id       date       pval       alphai R #> 1  A15432 2014-12-01 2.9000e-17 0.0026758385 1 #> 2  B90969 2014-12-01 6.7430e-02 0.0005819103 0 #> 3  C18705 2014-12-01 1.5140e-02 0.0004956249 0 #> 4  B49731 2015-09-21 8.1740e-02 0.0004121803 0 #> 5  E99902 2015-09-21 1.7100e-03 0.0003494435 0 #> 6  D46627 2015-09-21 2.7201e-01 0.0003022950 0 #> 7  C38292 2015-09-21 3.6000e-05 0.0002659722 1 #> 8  A30619 2015-09-21 7.9149e-01 0.0002372613 0 #> 9  A41418 2016-05-19 7.5900e-08 0.0002140474 1 #> 10 E29198 2016-05-19 2.8295e-01 0.0001949126 0 #> 11 D51456 2016-11-12 6.9274e-01 0.0001788796 0 #> 12 A63155 2017-03-27 7.2342e-01 0.0001652568 0 #> 13 C88669 2017-03-27 3.0443e-01 0.0001535420 0 #> 14 B66033 2017-03-27 5.4757e-01 0.0001433627 0 #> 15 E03673 2017-03-27 1.3600e-03 0.0001344368 0  Alpha_spending(sample.df, random=FALSE) #>        id       date       pval       alphai R #> 1  A15432 2014-12-01 2.9000e-17 0.0026758385 1 #> 2  B90969 2014-12-01 6.7430e-02 0.0005819103 0 #> 3  C18705 2014-12-01 1.5140e-02 0.0004956249 0 #> 4  B49731 2015-09-21 8.1740e-02 0.0004121803 0 #> 5  E99902 2015-09-21 1.7100e-03 0.0003494435 0 #> 6  C38292 2015-09-21 3.6000e-05 0.0003022950 1 #> 7  A30619 2015-09-21 7.9149e-01 0.0002659722 0 #> 8  D46627 2015-09-21 2.7201e-01 0.0002372613 0 #> 9  E29198 2016-05-19 2.8295e-01 0.0002140474 0 #> 10 A41418 2016-05-19 7.5900e-08 0.0001949126 1 #> 11 D51456 2016-11-12 6.9274e-01 0.0001788796 0 #> 12 C88669 2017-03-27 3.0443e-01 0.0001652568 0 #> 13 E03673 2017-03-27 1.3600e-03 0.0001535420 0 #> 14 A63155 2017-03-27 7.2342e-01 0.0001433627 0 #> 15 B66033 2017-03-27 5.4757e-01 0.0001344368 0  set.seed(1); Alpha_spending(sample.df, alpha=0.1) #>        id       date       pval       alphai R #> 1  A15432 2014-12-01 2.9000e-17 0.0053516771 1 #> 2  B90969 2014-12-01 6.7430e-02 0.0011638206 0 #> 3  C18705 2014-12-01 1.5140e-02 0.0009912499 0 #> 4  B49731 2015-09-21 8.1740e-02 0.0008243606 0 #> 5  E99902 2015-09-21 1.7100e-03 0.0006988870 0 #> 6  D46627 2015-09-21 2.7201e-01 0.0006045900 0 #> 7  C38292 2015-09-21 3.6000e-05 0.0005319444 1 #> 8  A30619 2015-09-21 7.9149e-01 0.0004745225 0 #> 9  A41418 2016-05-19 7.5900e-08 0.0004280949 1 #> 10 E29198 2016-05-19 2.8295e-01 0.0003898252 0 #> 11 D51456 2016-11-12 6.9274e-01 0.0003577593 0 #> 12 A63155 2017-03-27 7.2342e-01 0.0003305137 0 #> 13 C88669 2017-03-27 3.0443e-01 0.0003070841 0 #> 14 B66033 2017-03-27 5.4757e-01 0.0002867254 0 #> 15 E03673 2017-03-27 1.3600e-03 0.0002688736 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":null,"dir":"Reference","previous_headings":"","what":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"Implements BatchBH algorithm online FDR control, presented Zrnic et al. (2020).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"","code":"BatchBH(d, alpha = 0.05, gammai, display_progress = FALSE)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"d dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"dataframe original data d   indicator function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value within \\(t\\)-th batch less equal   \\((r/n)\\alpha_t\\), \\(r\\) rank \\(\\)-th p-value   within ordered set \\(n\\) total number hypotheses within   \\(t\\)-th batch. hypothesis \\(\\) rejected, R[] = 1   (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"function takes input dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). BatchBH algorithm controls FDR p-values batch independent, independent across batches. Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\gamma_i\\) sum 1. algorithm runs Benjamini-Hochberg procedure batch, values adjusted significance thresholds \\(\\alpha_{t+1}\\) depend number previous discoveries. details BatchBH algorithm can found Zrnic et al. (2020).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"Zrnic, T., Jiang D., Ramdas . Jordan M. (2020). Power   Batching Multiple Hypothesis Testing. International Conference   Artificial Intelligence Statistics, 3806-3815.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchBH.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"BatchBH: Online batch FDR control using the BH procedure — BatchBH","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), batch = c(rep(1,5), rep(2,6), rep(3,4)))  BatchBH(sample.df) #>        id       pval batch R      alphai #> 1  A15432 2.9000e-08     1 1 0.021874508 #> 2  B90969 6.7430e-02     1 0 0.021874508 #> 3  C18705 1.5140e-02     1 0 0.021874508 #> 4  B49731 8.1740e-02     1 0 0.021874508 #> 5  E99902 1.7100e-03     1 1 0.021874508 #> 6  C38292 3.6000e-05     2 1 0.009621196 #> 7  A30619 7.9149e-01     2 0 0.009621196 #> 8  D46627 2.7201e-01     2 0 0.009621196 #> 9  E29198 2.8295e-01     2 0 0.009621196 #> 10 A41418 7.5900e-08     2 1 0.009621196 #> 11 D51456 6.9274e-01     2 0 0.009621196 #> 12 C88669 3.0443e-01     3 0 0.025012888 #> 13 E03673 1.3600e-03     3 1 0.025012888 #> 14 A63155 7.2342e-01     3 0 0.025012888 #> 15 B66033 5.4757e-01     3 0 0.025012888"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":null,"dir":"Reference","previous_headings":"","what":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"Implements BatchPRDS algorithm online FDR control, PRDS stands positive regression dependency subset, presented Zrnic et al. (2020).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"","code":"BatchPRDS(d, alpha = 0.05, gammai, display_progress = FALSE)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"d dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"dataframe original data d   indicator function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value within \\(t\\)-th batch less equal   \\((r/n)\\alpha_t\\), \\(r\\) rank \\(\\)-th p-value   within ordered set \\(n\\) total number hypotheses within   \\(t\\)-th batch. hypothesis \\(\\) rejected, R[] = 1   (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"function takes input dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). BatchPRDS algorithm controls FDR p-values one batch positively dependent, independent across batches. Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\gamma_i\\) sum 1. algorithm runs Benjamini-Hochberg procedure batch, values adjusted significance thresholds \\(\\alpha_{t+1}\\) depend number previous discoveries. details BatchPRDS algorithm can found Zrnic et al. (2020).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"Zrnic, T., Jiang D., Ramdas . Jordan M. (2020). Power   Batching Multiple Hypothesis Testing. International Conference   Artificial Intelligence Statistics: 3806-3815","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchPRDS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"BatchPRDS: Online batch FDR control under Positive Dependence — BatchPRDS","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), batch = c(rep(1,5), rep(2,6), rep(3,4)))  BatchPRDS(sample.df) #>        id       pval batch R      alphai #> 1  A15432 2.9000e-08     1 1 0.021874508 #> 2  B90969 6.7430e-02     1 0 0.021874508 #> 3  C18705 1.5140e-02     1 0 0.021874508 #> 4  B49731 8.1740e-02     1 0 0.021874508 #> 5  E99902 1.7100e-03     1 1 0.021874508 #> 6  C38292 3.6000e-05     2 1 0.009621196 #> 7  A30619 7.9149e-01     2 0 0.009621196 #> 8  D46627 2.7201e-01     2 0 0.009621196 #> 9  E29198 2.8295e-01     2 0 0.009621196 #> 10 A41418 7.5900e-08     2 1 0.009621196 #> 11 D51456 6.9274e-01     2 0 0.009621196 #> 12 C88669 3.0443e-01     3 0 0.007543524 #> 13 E03673 1.3600e-03     3 1 0.007543524 #> 14 A63155 7.2342e-01     3 0 0.007543524 #> 15 B66033 5.4757e-01     3 0 0.007543524"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":null,"dir":"Reference","previous_headings":"","what":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"Implements BatchSt-BH algorithm online FDR control, presented Zrnic et al. (2020). algorithm makes one modification original Storey-BH algorithm (Storey 2002), adding 1 numerator null proportion estimate stable results.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"","code":"BatchStBH(d, alpha = 0.05, gammai, lambda = 0.5, display_progress = FALSE)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"d dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). lambda Threshold Storey-BH, must 0 1. Defaults 0.5. display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"dataframe original data d   indicator function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value within \\(t\\)-th batch less equal   \\((r/n)\\alpha_t\\), \\(r\\) rank \\(\\)-th p-value   within ordered set \\(n\\) total number hypotheses within   \\(t\\)-th batch. hypothesis \\(\\) rejected, R[] = 1   (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"function takes input dataframe three columns: identifiers (`id'), batch numbers (`batch') p-values (`pval'). BatchSt-BH algorithm controls FDR p-values batch independent, independent across batches. Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\gamma_i\\) sum 1. algorithm runs Storey Benjamini-Hochberg procedure batch, values adjusted significance thresholds \\(\\alpha_{t+1}\\) depend number previous discoveries. details BatchSt-BH algorithm can found Zrnic et al. (2020).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"Storey, J.D. (2002). direct approach false discovery rates.   J. R. Statist. Soc. B: 64, Part 3, 479-498. Zrnic, T., Jiang D., Ramdas . Jordan M. (2020). Power Batching   Multiple Hypothesis Testing. International Conference   Artificial Intelligence Statistics: 3806-3815","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/BatchStBH.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"BatchStBH: Online batch FDR control using the St-BH procedure — BatchStBH","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), batch = c(rep(1,5), rep(2,6), rep(3,4)))  BatchStBH(sample.df) #>        id       pval batch R     alphai #> 1  A15432 2.9000e-08     1 1 0.02187451 #> 2  B90969 6.7430e-02     1 0 0.02187451 #> 3  C18705 1.5140e-02     1 1 0.02187451 #> 4  B49731 8.1740e-02     1 0 0.02187451 #> 5  E99902 1.7100e-03     1 1 0.02187451 #> 6  C38292 3.6000e-05     2 1 0.04363561 #> 7  A30619 7.9149e-01     2 0 0.04363561 #> 8  D46627 2.7201e-01     2 0 0.04363561 #> 9  E29198 2.8295e-01     2 0 0.04363561 #> 10 A41418 7.5900e-08     2 1 0.04363561 #> 11 D51456 6.9274e-01     2 0 0.04363561 #> 12 C88669 3.0443e-01     3 0 0.02484982 #> 13 E03673 1.3600e-03     3 1 0.02484982 #> 14 A63155 7.2342e-01     3 0 0.02484982 #> 15 B66033 5.4757e-01     3 0 0.02484982"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":null,"dir":"Reference","previous_headings":"","what":"Online FDR control based on a Bonferroni-like test — bonfInfinite","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"funcion deprecated, please use Alpha_spending instead.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"","code":"bonfInfinite(   d,   alpha = 0.05,   alphai,   random = TRUE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. alphai Optional vector \\(\\alpha_i\\), hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\). default provided proposed Javanmard Montanari (2018), equation 31. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"d.dataframe original data d ( reordered batches random = TRUE),  adjusted signifcance thresholds alphai indicator function  discoveries R, R[] = 1 corresponds hypothesis  \\(\\) rejected (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"Implements online FDR control using Bonferroni-like test. function takes input either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. procedure controls FDR potentially infinite stream p-values using Bonferroni-like test. Given overall significance level \\(\\alpha\\), choose (potentially infinite) sequence non-negative numbers \\(\\alpha_i\\) sum \\(\\alpha\\). Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/bonfInfinite.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Online FDR control based on a Bonferroni-like test — bonfInfinite","text":"Javanmard, . Montanari, . (2018) Online Rules Control  False Discovery Rate False Discovery Exceedance. Annals  Statistics, 46(2):526-554.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":null,"dir":"Reference","previous_headings":"","what":"LOND: Online FDR control based on number of discoveries — LOND","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"Implements LOND algorithm online FDR control, LOND stands (significance) Levels based Number Discoveries, presented Javanmard Montanari (2015).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"","code":"LOND(   d,   alpha = 0.05,   betai,   dep = FALSE,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\",   original = TRUE )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. betai Optional vector \\(\\beta_i\\). default provided proposed Javanmard Montanari (2018), equation 31. dep Logical. TRUE, runs modified LOND algorithm guarantees FDR control dependent p-values. Defaults FALSE. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates. original Logical. TRUE, runs original LOND algorithm Javanmard Montanari (2015), otherwise runs modified algorithm Zrnic et al. (2018). Defaults TRUE.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"dataframe original data d (reordered batches random = TRUE), LOND-adjusted significance thresholds \\(\\alpha_i\\) indicator function discoveries R. Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\), case R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. LOND algorithm controls FDR independent p-values (see modification dependent p-values). Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\beta_i\\) sum \\(\\alpha\\). values adjusted significance thresholds \\(\\alpha_i\\) chosen follows: $$\\alpha_i = (D(-1) + 1)\\beta_i$$ \\(D(n)\\) denotes number discoveries first \\(n\\) hypotheses. slightly modified version LOND thresholds \\(\\alpha_i = max(D(-1), 1)\\beta_i\\) provably controls FDR positive dependence (PRDS condition), see Zrnic et al. (2021). arbitrarily dependent p-values, LOND controls FDR modified \\(\\beta_i / H()\\) place \\(\\beta_i\\), \\(H(j)\\) -th harmonic number. details LOND algorithm can found Javanmard Montanari (2015).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"Javanmard, . Montanari, . (2015) Online Control False Discovery Rate. arXiv preprint, https://arxiv.org/abs/1502.06197. Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research (appear), https://arxiv.org/abs/1812.05068.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LOND.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LOND: Online FDR control based on number of discoveries — LOND","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                 rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                 rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  set.seed(1); LOND(sample.df) #>          pval       alphai R #> 1  2.9000e-08 0.0026758385 1 #> 2  6.7430e-02 0.0011638206 0 #> 3  1.5140e-02 0.0009912499 0 #> 4  8.1740e-02 0.0008243606 0 #> 5  1.7100e-03 0.0006988870 0 #> 6  2.7201e-01 0.0006045900 0 #> 7  3.6000e-05 0.0005319444 1 #> 8  7.9149e-01 0.0007117838 0 #> 9  7.5900e-08 0.0006421423 1 #> 10 2.8295e-01 0.0007796504 0 #> 11 6.9274e-01 0.0007155186 0 #> 12 7.2342e-01 0.0006610273 0 #> 13 3.0443e-01 0.0006141682 0 #> 14 5.4757e-01 0.0005734509 0 #> 15 1.3600e-03 0.0005377472 0  LOND(sample.df, random=FALSE) #>          pval       alphai R #> 1  2.9000e-08 0.0026758385 1 #> 2  6.7430e-02 0.0011638206 0 #> 3  1.5140e-02 0.0009912499 0 #> 4  8.1740e-02 0.0008243606 0 #> 5  1.7100e-03 0.0006988870 0 #> 6  3.6000e-05 0.0006045900 1 #> 7  7.9149e-01 0.0007979166 0 #> 8  2.7201e-01 0.0007117838 0 #> 9  2.8295e-01 0.0006421423 0 #> 10 7.5900e-08 0.0005847378 1 #> 11 6.9274e-01 0.0007155186 0 #> 12 3.0443e-01 0.0006610273 0 #> 13 1.3600e-03 0.0006141682 0 #> 14 7.2342e-01 0.0005734509 0 #> 15 5.4757e-01 0.0005377472 0  set.seed(1); LOND(sample.df, alpha=0.1) #>          pval      alphai R #> 1  2.9000e-08 0.005351677 1 #> 2  6.7430e-02 0.002327641 0 #> 3  1.5140e-02 0.001982500 0 #> 4  8.1740e-02 0.001648721 0 #> 5  1.7100e-03 0.001397774 0 #> 6  2.7201e-01 0.001209180 0 #> 7  3.6000e-05 0.001063889 1 #> 8  7.9149e-01 0.001423568 0 #> 9  7.5900e-08 0.001284285 1 #> 10 2.8295e-01 0.001559301 0 #> 11 6.9274e-01 0.001431037 0 #> 12 7.2342e-01 0.001322055 0 #> 13 3.0443e-01 0.001228336 0 #> 14 5.4757e-01 0.001146902 0 #> 15 1.3600e-03 0.001075494 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":null,"dir":"Reference","previous_headings":"","what":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"Implements LOND algorithm asynchronous online testing, presented Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"","code":"LONDstar(   d,   alpha = 0.05,   version,   betai,   batch.sizes,   display_progress = FALSE )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"d Either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), either `decision.times', `lags', depending version using. See version details. alpha Overall significance level procedure, default 0.05. version Takes values 'async', 'dep' 'batch'. specifies version LONDstar use. version='async' requires column decision times (`decision.times'). version='dep' requires column lags (`lags'). version='batch' requires vector batch sizes (`batch.sizes'). betai Optional vector \\(\\beta_i\\). default provided proposed Javanmard Montanari (2018), equation 31. batch.sizes vector batch sizes, required version='batch'. display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"dataframe original p-values pval, adjusted testing levels \\(\\alpha_i\\) indicator function discoveries R. Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\), case R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), column describing conflict sets hypotheses. takes form vector decision times lags. Batch sizes can specified separate argument (see ). Zrnic et al. (2021) present explicit three versions LONDstar: 1) version='async' asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. decision times given input decision.times version LONDstar algorithm. 2) version='dep' online testing local dependence p-values. precisely, \\(t>0\\) allow p-value \\(p_t\\) arbitrary dependence previous \\(L_t\\) p-values. fixed sequence \\(L_t\\) referred `lags', given input lags version LONDstar algorithm. 3) version='batch' controlling mFDR mini-batch testing, mini-batch represents grouping tests run asynchronously result dependent p-values. mini-batch tests fully completed, new one can start, testing hypotheses independent previous batch. batch sizes given input batch.sizes version LONDstar algorithm. Given overall significance level \\(\\alpha\\), LONDstar requires sequence non-negative non-increasing numbers \\(\\beta_i\\) sum \\(\\alpha\\). Note LONDstar algorithms control modified FDR (mFDR). details LONDstar algorithms can found Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research (appear), https://arxiv.org/abs/1812.05068.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LONDstar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LONDstar: Asynchronous online mFDR control based on number of discoveries — LONDstar","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), decision.times = seq_len(15) + 1)  LONDstar(sample.df, version='async') #>          pval       alphai R #> 1  2.9000e-08 0.0026758385 1 #> 2  6.7430e-02 0.0005819103 0 #> 3  1.5140e-02 0.0004956249 0 #> 4  8.1740e-02 0.0004121803 0 #> 5  1.7100e-03 0.0003494435 0 #> 6  3.6000e-05 0.0003022950 1 #> 7  7.9149e-01 0.0002659722 0 #> 8  2.7201e-01 0.0004745225 0 #> 9  2.8295e-01 0.0004280949 0 #> 10 7.5900e-08 0.0003898252 1 #> 11 6.9274e-01 0.0003577593 0 #> 12 3.0443e-01 0.0004957705 0 #> 13 1.3600e-03 0.0004606261 0 #> 14 7.2342e-01 0.0004300881 0 #> 15 5.4757e-01 0.0004033104 0  sample.df2 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), lags = rep(1,15))  LONDstar(sample.df2, version='dep') #>          pval lag       alphai R #> 1  2.9000e-08   1 0.0026758385 1 #> 2  6.7430e-02   1 0.0005819103 0 #> 3  1.5140e-02   1 0.0004956249 0 #> 4  8.1740e-02   1 0.0004121803 0 #> 5  1.7100e-03   1 0.0003494435 0 #> 6  3.6000e-05   1 0.0003022950 1 #> 7  7.9149e-01   1 0.0002659722 0 #> 8  2.7201e-01   1 0.0004745225 0 #> 9  2.8295e-01   1 0.0004280949 0 #> 10 7.5900e-08   1 0.0003898252 1 #> 11 6.9274e-01   1 0.0003577593 0 #> 12 3.0443e-01   1 0.0004957705 0 #> 13 1.3600e-03   1 0.0004606261 0 #> 14 7.2342e-01   1 0.0004300881 0 #> 15 5.4757e-01   1 0.0004033104 0  sample.df3 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  LONDstar(sample.df3, version='batch', batch.sizes = c(4,6,5))"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":null,"dir":"Reference","previous_headings":"","what":"LORD: Online FDR control based on recent discovery — LORD","title":"LORD: Online FDR control based on recent discovery — LORD","text":"Implements LORD procedure online FDR control, LORD stands (significance) Levels based Recent Discovery, presented Javanmard Montanari (2018) Ramdas et al. (2017).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LORD: Online FDR control based on recent discovery — LORD","text":"","code":"LORD(   d,   alpha = 0.05,   gammai,   version = \"++\",   w0,   b0,   tau.discard = 0.5,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LORD: Online FDR control based on recent discovery — LORD","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided proposed Javanmard Montanari (2018), equation 31 versions LORD except 'dep'. latter provided default satisfy condition given Javanmard Montanari (2018), example 3.8. version Takes values '++', 3, 'discard', 'dep'. specifies version LORD use, defaults '++'. w0 Initial `wealth' procedure, defaults \\(\\alpha/10\\). b0 'payout' rejecting hypothesis versions LORD except '++'. Defaults \\(\\alpha - w_0\\). tau.discard Optional threshold hypotheses selected testing. Must 0 1, defaults 0.5. required version='discard'. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LORD: Online FDR control based on recent discovery — LORD","text":"d.dataframe original data d (  reordered batches random = TRUE),   LORD-adjusted significance thresholds \\(\\alpha_i\\) indicator   function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\(\\alpha_i\\), case   R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LORD: Online FDR control based on recent discovery — LORD","text":"function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time.. LORD procedure provably controls FDR independent p-values (see dependent p-values). Given overall significance level \\(\\alpha\\), choose sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. Javanmard Montanari (2018) presented versions LORD differ way adjusted significance thresholds \\(\\alpha_i\\) calculated. significance thresholds LORD 2 based previous discovery times. LORD 2 superseded algorithm given Ramdas et al. (2017), LORD++ (version='++'), default version. significance thresholds LORD 3 (version=3) based time last discovery well 'wealth' accumulated time. Finally, Tian Ramdas (2019) presented version LORD (version='discard') can improve power procedure presence conservative nulls adaptively `discarding' p-values. LORD depends constants \\(w_0\\) (versions 3 'dep') \\(b_0\\), \\(0 \\le w_0 \\le \\alpha\\) represents initial `wealth' procedure \\(b_0 > 0\\) represents `payout' rejecting hypothesis. require \\(w_0+b_0 \\le \\alpha\\) FDR control hold. Version 'discard' also depends constant \\(\\tau\\), \\(\\tau \\(0,1)\\) represents threshold hypothesis selected testing: p-values greater \\(\\tau\\) implicitly `discarded' procedure. Note FDR control also holds LORD procedure p-values corresponding true nulls mutually independent, independent non-null p-values. dependent p-values, modified LORD procedure proposed Javanmard Montanari (2018), called setting version='dep'. Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\xi_i\\) satisfy condition given Javanmard Montanari (2018), example 3.8. details LORD procedures can found Javanmard Montanari (2018), Ramdas et al. (2017) Tian Ramdas (2019).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LORD: Online FDR control based on recent discovery — LORD","text":"Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Ramdas, ., Yang, F., Wainwright M.J. Jordan, M.. (2017). Online control false discovery rate decaying memory. Advances Neural Information Processing Systems 30, 5650-5659. Tian, J. Ramdas, . (2019). ADDIS: adaptive discarding algorithm online FDR control conservative nulls. Advances Neural Information Processing Systems, 9388-9396.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LORD: Online FDR control based on recent discovery — LORD","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                 rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                 rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  LORD(sample.df, random=FALSE) #>          pval       alphai R     id #> 1  2.9000e-08 0.0002675839 1 A15432 #> 2  6.7430e-02 0.0024664457 0 B90969 #> 3  1.5140e-02 0.0005732818 0 C18705 #> 4  8.1740e-02 0.0004872805 0 B49731 #> 5  1.7100e-03 0.0004059066 0 E99902 #> 6  3.6000e-05 0.0003447286 1 C38292 #> 7  7.9149e-01 0.0029745013 0 A30619 #> 8  2.7201e-01 0.0008450114 0 D46627 #> 9  2.8295e-01 0.0007305648 0 E29198 #> 10 7.5900e-08 0.0006243143 1 A41418 #> 11 6.9274e-01 0.0032185913 0 D51456 #> 12 3.0443e-01 0.0010617227 0 C88669 #> 13 1.3600e-03 0.0009256825 0 E03673 #> 14 7.2342e-01 0.0008019657 0 A63155 #> 15 5.4757e-01 0.0007059610 0 B66033  set.seed(1); LORD(sample.df, version='dep') #>          pval       alphai R     id #> 1  2.9000e-08 2.091542e-03 1 A15432 #> 2  6.7430e-02 1.002025e-02 0 B90969 #> 3  1.5140e-02 1.677763e-03 0 C18705 #> 4  8.1740e-02 6.262659e-04 0 B49731 #> 5  1.7100e-03 3.201787e-04 0 E99902 #> 6  2.7201e-01 1.933725e-04 0 D46627 #> 7  3.6000e-05 1.293954e-04 1 C38292 #> 8  7.9149e-01 1.548152e-04 0 A30619 #> 9  7.5900e-08 1.166482e-04 1 A41418 #> 10 2.8295e-01 1.422614e-04 0 E29198 #> 11 6.9274e-01 1.145119e-04 0 D51456 #> 12 7.2342e-01 9.432408e-05 0 A63155 #> 13 3.0443e-01 7.916885e-05 0 C88669 #> 14 5.4757e-01 6.749313e-05 0 B66033 #> 15 1.3600e-03 5.830055e-05 0 E03673  set.seed(1); LORD(sample.df, version='discard') #>          pval       alphai R     id #> 1  2.9000e-08 0.0002675839 1 A15432 #> 2  6.7430e-02 0.0011285264 0 B90969 #> 3  1.5140e-02 0.0002823266 0 C18705 #> 4  8.1740e-02 0.0002394680 0 B49731 #> 5  1.7100e-03 0.0001998165 0 E99902 #> 6  2.7201e-01 0.0001700069 0 D46627 #> 7  3.6000e-05 0.0001475152 1 C38292 #> 8  7.9149e-01 0.0014680343 0 A30619 #> 9  7.5900e-08 0.0014680343 1 A41418 #> 10 2.8295e-01 0.0017451837 0 E29198 #> 11 6.9274e-01 0.0006438778 0 D51456 #> 12 7.2342e-01 0.0006438778 0 A63155 #> 13 3.0443e-01 0.0006438778 0 C88669 #> 14 5.4757e-01 0.0005497556 0 B66033 #> 15 1.3600e-03 0.0005497556 0 E03673  set.seed(1); LORD(sample.df, alpha=0.1, w0=0.05) #>          pval       alphai R     id #> 1  2.9000e-08 0.0026758385 1 A15432 #> 2  6.7430e-02 0.0032577488 0 B90969 #> 3  1.5140e-02 0.0010775352 0 C18705 #> 4  8.1740e-02 0.0009078052 0 B49731 #> 5  1.7100e-03 0.0007616238 0 E99902 #> 6  2.7201e-01 0.0006517385 0 D46627 #> 7  3.6000e-05 0.0005682672 1 C38292 #> 8  7.9149e-01 0.0058549106 0 A30619 #> 9  7.5900e-08 0.0016151293 1 A41418 #> 10 2.8295e-01 0.0067518870 0 E29198 #> 11 6.9274e-01 0.0023619734 0 D51456 #> 12 7.2342e-01 0.0020342733 0 A63155 #> 13 3.0443e-01 0.0017477495 0 C88669 #> 14 5.4757e-01 0.0015277362 0 B66033 #> 15 1.3600e-03 0.0013569121 0 E03673"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":null,"dir":"Reference","previous_headings":"","what":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"funcion deprecated, please use LORD instead version = 'dep'.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"","code":"LORDdep(   d,   alpha = 0.05,   xi,   w0 = alpha/10,   b0 = alpha - w0,   random = TRUE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. xi Optional vector \\(\\xi_i\\). default provided satisfy condition given Javanmard Montanari (2018), example 3.7. w0 Initial `wealth' procedure. Defaults \\(\\alpha/10\\). b0 `payout' rejecting hypothesis. Defaults \\(\\alpha - w_0\\). random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"d.dataframe original data d (reordered batches random = TRUE), LORD-adjusted significance thresholds \\(\\alpha_i\\) indicator function discoveries R. Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\), case R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"LORDdep implements LORD procedure online FDR control dependent p-values, LORD stands (significance) Levels based Recent Discovery, presented Javanmard Montanari (2018). function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. modified LORD procedure controls FDR dependent p-values. Given overall significance level \\(\\alpha\\), choose sequence non-negative numbers \\(\\xi_i\\) satisfy condition given Javanmard Montanari (2018), example 3.8. procedure depends constants \\(w_0\\) \\(b_0\\), \\(w_0 \\ge 0\\) represents intial `wealth' \\(b_0 > 0\\) represents `payout' rejecting hypothesis. require \\(w_0+b_0 \\le \\alpha\\) FDR control hold. details modified LORD procedure can found Javanmard Montanari (2018).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDdep.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LORD (dep): Online FDR control based on recent discovery for dependent p-values — LORDdep","text":"Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":null,"dir":"Reference","previous_headings":"","what":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"Implements LORD algorithms asynchronous online testing, presented Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"","code":"LORDstar(   d,   alpha = 0.05,   version,   gammai,   w0,   batch.sizes,   display_progress = FALSE )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"d Either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), either `decision.times', `lags', depending version using. See version details. alpha Overall significance level procedure, default 0.05. version Takes values 'async', 'dep' 'batch'. specifies   version LORDstar use. version='async' requires column decision times (`decision.times'). version='dep' requires column lags (`lags'). version='batch' requires vector batch sizes (`batch.sizes'). gammai Optional vector \\(\\gamma_i\\). default provided proposed Javanmard Montanari (2018), equation 31. w0 Initial `wealth' procedure, defaults \\(\\alpha/10\\). batch.sizes vector batch sizes, required version='batch'. display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"dataframe original p-values pval, adjusted testing levels \\(\\alpha_i\\) indicator function discoveries R. Hypothesis \\(\\) rejected \\(\\)-th p-value less equal \\(\\alpha_i\\), case R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), column describing conflict sets hypotheses. takes form vector decision times lags. Batch sizes can specified separate argument (see ). Zrnic et al. (2021) present explicit three versions LORDstar: 1) version='async' asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. decision times given input decision.times version LORDstar algorithm. 2) version='dep' online testing local dependence p-values. precisely, \\(t>0\\) allow p-value \\(p_t\\) arbitrary dependence previous \\(L_t\\) p-values. fixed sequence \\(L_t\\) referred `lags', given input lags version LORDstar algorithm. 3) version='batch' controlling mFDR mini-batch testing, mini-batch represents grouping tests run asynchronously result dependent p-values. mini-batch tests fully completed, new one can start, testing hypotheses independent previous batch. batch sizes given input batch.sizes version LORDstar algorithm. Given overall significance level \\(\\alpha\\), LORDstar depends \\(w_0\\) (\\(0 \\le w_0 \\le \\alpha\\)), represents intial `wealth' procedure. algorithms also require sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. Note LORDstar algorithms control modified FDR (mFDR). `async' version also controls usual FDR p-values assumed independent. details LORDstar algorithms can found Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research 22:1-33.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/LORDstar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LORDstar: Asynchronous online mFDR control based on recent discovery — LORDstar","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), decision.times = seq_len(15) + 1)  LORDstar(sample.df, version='async') #>          pval       alphai R #> 1  2.9000e-08 2.675839e-04 1 #> 2  6.7430e-02 5.819103e-05 0 #> 3  1.5140e-02 2.457817e-03 0 #> 4  8.1740e-02 5.649373e-04 0 #> 5  1.7100e-03 4.810068e-04 0 #> 6  3.6000e-05 4.011918e-04 1 #> 7  7.9149e-01 3.410964e-04 0 #> 8  2.7201e-01 2.971630e-03 0 #> 9  2.8295e-01 8.426900e-04 0 #> 10 7.5900e-08 7.286513e-04 1 #> 11 6.9274e-01 6.227110e-04 0 #> 12 3.0443e-01 3.217229e-03 0 #> 13 1.3600e-03 1.060551e-03 0 #> 14 7.2342e-01 9.246646e-04 0 #> 15 5.4757e-01 8.010731e-04 0  sample.df2 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), lags = rep(1,15))  LORDstar(sample.df2, version='dep') #>          pval lag       alphai R #> 1  2.9000e-08   1 2.675839e-04 1 #> 2  6.7430e-02   1 5.819103e-05 0 #> 3  1.5140e-02   1 2.457817e-03 0 #> 4  8.1740e-02   1 5.649373e-04 0 #> 5  1.7100e-03   1 4.810068e-04 0 #> 6  3.6000e-05   1 4.011918e-04 1 #> 7  7.9149e-01   1 3.410964e-04 0 #> 8  2.7201e-01   1 2.971630e-03 0 #> 9  2.8295e-01   1 8.426900e-04 0 #> 10 7.5900e-08   1 7.286513e-04 1 #> 11 6.9274e-01   1 6.227110e-04 0 #> 12 3.0443e-01   1 3.217229e-03 0 #> 13 1.3600e-03   1 1.060551e-03 0 #> 14 7.2342e-01   1 9.246646e-04 0 #> 15 5.4757e-01   1 8.010731e-04 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-deprecated.html","id":null,"dir":"Reference","previous_headings":"","what":"Deprecated functions in package ‘onlineFDR’ — onlineFDR-deprecated","title":"Deprecated functions in package ‘onlineFDR’ — onlineFDR-deprecated","text":"functions provided compatibility older versions   ‘onlineFDR’ , defunct next release.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-deprecated.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Deprecated functions in package ‘onlineFDR’ — onlineFDR-deprecated","text":"following functions deprecated made defunct; use   replacement indicated : LORDdep: LORD version='dep' bonfInfinite: Alpha_spending","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"onlineFDR: A package for online error rate control — onlineFDR-package","title":"onlineFDR: A package for online error rate control — onlineFDR-package","text":"onlineFDR package provides methods control false discovery rate (FDR) familywise error rate (FWER) online hypothesis testing, hypotheses arrive stream. null hypothesis rejected based evidence previous rejection decisions.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"onlineFDR: A package for online error rate control — onlineFDR-package","text":"Javanmard Montanari (2015, 2018) proposed two methods online FDR control. first LORD, stands (significance) Levels based Recent Discovery implemented function LORD. function also includes extension LORD procedure, called LORD++ (version='++'), proposed Ramdas et al. (2017). Setting version='discard' implements modified version LORD can improve power procedure presence conservative nulls adaptively `discarding' p-values, proposed Tian Ramdas (2019a). LORD procedures provably control FDR independence p-values. However, setting version='dep' provides modified version LORD valid arbitrarily dependent p-values. second method LOND, stands (significance) Levels based Number Discoveries implemented function LOND. procedure controls FDR independence p-values, slightly modified version LOND proposed Zrnic et al. (2018) also provably controls FDR positive dependence (PRDS conditioN). addition, specifying dep = TRUE, thus function runs modified version LOND valid arbitrarily dependent p-values. Another method online FDR control proposed Ramdas et al. (2018) SAFFRON procedure, stands Serial estimate Alpha Fraction Futiley Rationed true Null hypotheses. provides adaptive algorithm online FDR control. SAFFRON related Alpha-investing procedure Foster Stine (2008), monotone version implemented function Alpha_investing. procedure provably control FDR independence p-values. Tian Ramdas (2019) proposed ADDIS algorithm, stands ADaptive algorithm DIScards conservative nulls. algorithm compensates power loss SAFFRON conservative nulls, including adaptivity fraction null hypotheses (like SAFFRON) conservativeness nulls (unlike SAFFRON). ADDIS procedure provably controls FDR independent p-values. Tian Ramdas (2019) also presented version asynchronous testing process, consisting tests start finish (potentially) random times. testing batches hypotheses, Zrnic et al. (2020) proposed batched online testing algorithms control FDR, p-values across different batches independent, within batch p-values either positively dependent independent. Zrnic et al. (2021) generalised LOND, LORD SAFFRON asynchronous online testing, hypothesis test can sequential process tests can overlap time. Note though algorithms designed control modified FDR (mFDR). implemented functions LONDstar, LORDstar SAFFRONstar. Zrnic et al. (2021) presented three explicit versions algorithms: 1) version='async' asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. 2) version='dep' online testing local dependence p-values. precisely, \\(t>0\\) allow p-value \\(p_t\\) arbitrary dependence previous \\(L_t\\) p-values. fixed sequence \\(L_t\\) referred `lags'. 3) version='batch' controlling mFDR mini-batch testing, mini-batch represents grouping tests run asynchronously result dependent p-values. mini-batch tests fully completed, new one can start, testing hypotheses independent previous batch. Recently, Xu Ramdas (2021) proposed supLORD algorithm, provably controls false discovery exceedance (FDX) p-values conditionally superuniform null. supLORD also controls supFDR hence FDR (even stopping times). Finally, Tian Ramdas (2021) proposed number algorithms online FWER control. previously existing procedure online FWER control Alpha-spending, online analog Bonferroni procedure. implemented function Alpha_spending, provides strong FWER control arbitrarily dependent p-values. uniformly powerful method online_fallback, strongly controls FWER even arbitrary dependence amongst p-values. ADDIS_spending procedure compensates power loss Alpha-spending online fallback, including adapativity fraction null hypotheses conservativeness nulls. procedure controls FWER strong sense independent p-values. Tian Ramdas (2021) also presented version handling local dependence, can specified setting dep=TRUE. details procedures can found Javanmard Montanari (2015, 2018), Ramdas et al. (2017, 2018), Robertson Wason (2018), Tian Ramdas (2019, 2021), Xu Ramdas (2021), Zrnic et al. (2020, 2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"onlineFDR: A package for online error rate control — onlineFDR-package","text":"Aharoni, E. Rosset, S. (2014). Generalized \\(\\alpha\\)-investing: definitions, optimality results applications publci databases. Journal Royal Statistical Society (Series B), 76(4):771–794. Foster, D. Stine R. (2008). \\(\\alpha\\)-investing: procedure sequential control expected false discoveries. Journal Royal Statistical Society (Series B), 29(4):429-444. Javanmard, . Montanari, . (2015) Online Control False Discovery Rate. arXiv preprint, https://arxiv.org/abs/1502.06197. Javanmard, . Montanari, . (2018) Online Rules Control False Discovery Rate False Discovery Exceedance. Annals Statistics, 46(2):526-554. Ramdas, ., Yang, F., Wainwright M.J. Jordan, M.. (2017). Online control false discovery rate decaying memory. Advances Neural Information Processing Systems 30, 5650-5659. Ramdas, ., Zrnic, T., Wainwright M.J. Jordan, M.. (2018). SAFFRON: adaptive algorithm online control false discovery rate. Proceedings 35th International Conference Machine Learning, 80:4286-4294. Robertson, D.S. Wason, J.M.S. (2018). Online control false discovery rate biomedical research. arXiv preprint, https://arxiv.org/abs/1809.07292. Robertson, D.S., Wason, J.M.S. Ramdas, . (2022). Online multiple hypothesis testing reproducible research.arXiv preprint, https://arxiv.org/abs/2208.11418. Robertson, D.S., Wildenhain, J., Javanmard, . Karp, N.. (2019). onlineFDR: R package control false discovery rate growing data repositories. Bioinformatics, 35:4196-4199, doi:10.1093/bioinformatics/btz191 . Tian, J. Ramdas, . (2019). ADDIS: adaptive discarding algorithm online FDR control conservative nulls. Advances Neural Information Processing Systems, 9388-9396. Tian, J. Ramdas, . (2021). Online control familywise error rate. Statistical Methods Medical Research, 30(4):976–993. Xu, Z. Ramdas, . (2021). Dynamic Algorithms Online Multiple Testing. Annual Conference Mathematical Scientific Machine Learning, PMLR, 145:955-986. Zrnic, T., Jiang D., Ramdas . Jordan M. (2020). Power Batching Multiple Hypothesis Testing. International Conference Artificial Intelligence Statistics, PMLR, 108:3806-3815. Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research, 22:1-33.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/onlineFDR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"onlineFDR: A package for online error rate control — onlineFDR-package","text":"David S. Robertson (david.robertson@mrc-bsu.cam.ac.uk), Lathan Liou, Adel Javanmard, Aaditya Ramdas, Jinjin Tian, Tijana Zrnic, Andrea Montanari Natasha . Karp.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":null,"dir":"Reference","previous_headings":"","what":"Online fallback procedure for FWER control — online_fallback","title":"Online fallback procedure for FWER control — online_fallback","text":"Implements online fallback procedure Tian Ramdas (2021), guarantees strong FWER control arbitrary dependence p-values.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Online fallback procedure for FWER control — online_fallback","text":"","code":"online_fallback(   d,   alpha = 0.05,   gammai,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Online fallback procedure for FWER control — online_fallback","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided proposed Javanmard Montanari (2018), equation 31. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Online fallback procedure for FWER control — online_fallback","text":"dataframe original data d (  reordered batches random = TRUE),   LORD-adjusted significance thresholds \\(\\alpha_i\\) indicator   function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\(\\alpha_i\\), case   R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Online fallback procedure for FWER control — online_fallback","text":"function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. Given overall significance level \\(\\alpha\\), choose sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. online fallback procedure provides uniformly powerful method Alpha-spending, saving significance level previous rejection. specifically, procedure tests hypothesis \\(H_i\\) level $$\\alpha_i = \\alpha \\gamma_i + R_{-1} \\alpha_{-1}$$ \\(R_i = 1\\{p_i \\leq \\alpha_i\\}\\) denotes rejected hypothesis. details online fallback procedure can found Tian Ramdas (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Online fallback procedure for FWER control — online_fallback","text":"Tian, J. Ramdas, . (2021). Online control familywise error rate. Statistical Methods Medical Research, 30(4):976–993.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/online_fallback.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Online fallback procedure for FWER control — online_fallback","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  online_fallback(sample.df, random=FALSE) #>          pval       alphai R #> 1  2.9000e-08 0.0026758385 1 #> 2  6.7430e-02 0.0032577488 0 #> 3  1.5140e-02 0.0004956249 0 #> 4  8.1740e-02 0.0004121803 0 #> 5  1.7100e-03 0.0003494435 0 #> 6  3.6000e-05 0.0003022950 1 #> 7  7.9149e-01 0.0005682672 0 #> 8  2.7201e-01 0.0002372613 0 #> 9  2.8295e-01 0.0002140474 0 #> 10 7.5900e-08 0.0001949126 1 #> 11 6.9274e-01 0.0003737922 0 #> 12 3.0443e-01 0.0001652568 0 #> 13 1.3600e-03 0.0001535420 0 #> 14 7.2342e-01 0.0001433627 0 #> 15 5.4757e-01 0.0001344368 0  set.seed(1); online_fallback(sample.df) #>          pval       alphai R #> 1  2.9000e-08 0.0026758385 1 #> 2  6.7430e-02 0.0032577488 0 #> 3  1.5140e-02 0.0004956249 0 #> 4  8.1740e-02 0.0004121803 0 #> 5  1.7100e-03 0.0003494435 0 #> 6  2.7201e-01 0.0003022950 0 #> 7  3.6000e-05 0.0002659722 1 #> 8  7.9149e-01 0.0005032335 0 #> 9  7.5900e-08 0.0002140474 1 #> 10 2.8295e-01 0.0004089600 0 #> 11 6.9274e-01 0.0001788796 0 #> 12 7.2342e-01 0.0001652568 0 #> 13 3.0443e-01 0.0001535420 0 #> 14 5.4757e-01 0.0001433627 0 #> 15 1.3600e-03 0.0001344368 0  set.seed(1); online_fallback(sample.df, alpha=0.1) #>          pval       alphai R #> 1  2.9000e-08 0.0053516771 1 #> 2  6.7430e-02 0.0065154977 0 #> 3  1.5140e-02 0.0009912499 0 #> 4  8.1740e-02 0.0008243606 0 #> 5  1.7100e-03 0.0006988870 0 #> 6  2.7201e-01 0.0006045900 0 #> 7  3.6000e-05 0.0005319444 1 #> 8  7.9149e-01 0.0010064670 0 #> 9  7.5900e-08 0.0004280949 1 #> 10 2.8295e-01 0.0008179201 0 #> 11 6.9274e-01 0.0003577593 0 #> 12 7.2342e-01 0.0003305137 0 #> 13 3.0443e-01 0.0003070841 0 #> 14 5.4757e-01 0.0002867254 0 #> 15 1.3600e-03 0.0002688736 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":null,"dir":"Reference","previous_headings":"","what":"SAFFRON: Adaptive online FDR control — SAFFRON","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"Implements SAFFRON procedure online FDR control, SAFFRON stands Serial estimate Alpha Fraction Futilely Rationed true Null hypotheses, presented Ramdas et al. (2018). algorithm based estimate proportion true null hypotheses. precisely, SAFFRON sets adjusted test levels based estimate amount alpha-wealth allocated testing true null hypotheses.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"","code":"SAFFRON(   d,   alpha = 0.05,   gammai,   w0,   lambda = 0.5,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. alpha Overall significance level FDR procedure, default 0.05. gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). w0 Initial `wealth' procedure, defaults \\(\\alpha/2\\). Must 0 \\(\\alpha\\). lambda Optional threshold `candidate' hypothesis, must 0 1. Defaults 0.5. random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"dataframe original data d (  reordered batches random = TRUE),   LORD-adjusted significance thresholds \\(\\alpha_i\\) indicator   function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\(\\alpha_i\\), case   R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time. SAFFRON procedure provably controls FDR independent p-values. Given overall significance level \\(\\alpha\\), choose sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. SAFFRON depends constants \\(w_0\\) \\(\\lambda\\), \\(w_0\\) satisfies \\(0 \\le w_0 \\le \\alpha\\) represents initial `wealth' procedure, \\(0 < \\lambda < 1\\) represents threshold `candidate' hypothesis. `candidate' refers p-values smaller \\(\\lambda\\), since SAFFRON never reject p-value larger \\(\\lambda\\). Note FDR control also holds SAFFRON procedure p-values corresponding true nulls mutually independent, independent non-null p-values. SAFFRON procedure can lose power presence conservative nulls, can compensated adaptively `discarding' p-values. option called setting discard=TRUE, algorithm ADDIS. details SAFFRON procedure can found Ramdas et al. (2018).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"Ramdas, ., Zrnic, T., Wainwright M.J. Jordan, M.. (2018).   SAFFRON: adaptive algorithm online control false discovery   rate. Proceedings 35th International Conference Machine   Learning, 80:4286-4294.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRON.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SAFFRON: Adaptive online FDR control — SAFFRON","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), date = as.Date(c(rep('2014-12-01',3),                rep('2015-09-21',5),                 rep('2016-05-19',2),                 '2016-11-12',                rep('2017-03-27',4))), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757))  SAFFRON(sample.df, random=FALSE) #>          pval      alphai R     id #> 1  2.9000e-08 0.005468627 1 A15432 #> 2  6.7430e-02 0.010937254 0 B90969 #> 3  1.5140e-02 0.010937254 0 C18705 #> 4  8.1740e-02 0.010937254 0 B49731 #> 5  1.7100e-03 0.010937254 1 E99902 #> 6  3.6000e-05 0.021874508 1 C38292 #> 7  7.9149e-01 0.032811762 0 A30619 #> 8  2.7201e-01 0.010823845 0 D46627 #> 9  2.8295e-01 0.010823845 0 E29198 #> 10 7.5900e-08 0.010823845 1 A41418 #> 11 6.9274e-01 0.021761099 0 D51456 #> 12 3.0443e-01 0.009265591 0 C88669 #> 13 1.3600e-03 0.009265591 1 E03673 #> 14 7.2342e-01 0.020202846 0 A63155 #> 15 5.4757e-01 0.009064367 0 B66033  set.seed(1); SAFFRON(sample.df) #>          pval      alphai R     id #> 1  2.9000e-08 0.005468627 1 A15432 #> 2  6.7430e-02 0.010937254 0 B90969 #> 3  1.5140e-02 0.010937254 0 C18705 #> 4  8.1740e-02 0.010937254 0 B49731 #> 5  1.7100e-03 0.010937254 1 E99902 #> 6  2.7201e-01 0.021874508 0 D46627 #> 7  3.6000e-05 0.021874508 1 C38292 #> 8  7.9149e-01 0.032811762 0 A30619 #> 9  7.5900e-08 0.010823845 1 A41418 #> 10 2.8295e-01 0.021761099 0 E29198 #> 11 6.9274e-01 0.021761099 0 D51456 #> 12 7.2342e-01 0.009265591 0 A63155 #> 13 3.0443e-01 0.005456418 0 C88669 #> 14 5.4757e-01 0.005456418 0 B66033 #> 15 1.3600e-03 0.003688669 1 E03673  set.seed(1); SAFFRON(sample.df, alpha=0.1, w0=0.025) #>          pval      alphai R     id #> 1  2.9000e-08 0.005468627 1 A15432 #> 2  6.7430e-02 0.021874508 0 B90969 #> 3  1.5140e-02 0.021874508 1 C18705 #> 4  8.1740e-02 0.043749017 0 B49731 #> 5  1.7100e-03 0.043749017 1 E99902 #> 6  2.7201e-01 0.065623525 0 D46627 #> 7  3.6000e-05 0.065623525 1 C38292 #> 8  7.9149e-01 0.087498033 0 A30619 #> 9  7.5900e-08 0.028863587 1 A41418 #> 10 2.8295e-01 0.050738095 0 E29198 #> 11 6.9274e-01 0.050738095 0 D51456 #> 12 7.2342e-01 0.022302945 0 A63155 #> 13 3.0443e-01 0.013293195 0 C88669 #> 14 5.4757e-01 0.013293195 0 B66033 #> 15 1.3600e-03 0.009042997 1 E03673"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":null,"dir":"Reference","previous_headings":"","what":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"Implements SAFFRON algorithm asynchronous online testing, presented Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"","code":"SAFFRONstar(   d,   alpha = 0.05,   version,   gammai,   w0,   lambda = 0.5,   batch.sizes,   display_progress = FALSE )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"d Either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), either decision.times', `lags', depending version using. See version details. alpha Overall significance level procedure, default 0.05. version Takes values 'async', 'dep' 'batch'. specifies   version SAFFRONstar use. version='async' requires column decision times (`decision.times'). version='dep' requires column lags (`lags'). version='batch' requires vector batch sizes (`batch.sizes'). gammai Optional vector \\(\\gamma_i\\). default provided \\(\\gamma_j\\) proportional \\(1/j^(1.6)\\). w0 Initial `wealth' procedure, defaults \\(\\alpha/10\\). lambda Optional threshold `candidate' hypothesis, must 0 1. Defaults 0.5. batch.sizes vector batch sizes, required version='batch'. display_progress Logical. TRUE prints progress bar algorithm runtime.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"dataframe original p-values pval,   adjusted testing levels \\(\\alpha_i\\) indicator function   discoveries R. Hypothesis \\(\\) rejected \\(\\)-th   p-value less equal \\(\\alpha_i\\), case R[] =   1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"function takes input either vector p-values, dataframe three columns: identifier (`id'), p-value (`pval'), column describing conflict sets hypotheses. takes form vector decision times lags. Batch sizes can specified separate argument (see ). Zrnic et al. (2021) present explicit three versions SAFFRONstar: 1) version='async' asynchronous testing process, consisting tests start finish (potentially) random times. discretised finish times test correspond decision times. decision times given input decision.times version SAFFRONstar algorithm. version SAFFRONstar, Tian Ramdas (2019) presented algorithm can improve power procedure presence conservative nulls adaptively `discarding' p-values. can called setting option discard=TRUE. 2) version='dep' online testing local dependence p-values. precisely, \\(t>0\\) allow p-value \\(p_t\\) arbitrary dependence previous \\(L_t\\) p-values. fixed sequence \\(L_t\\) referred `lags', given input lags version SAFFRONstar algorithm. 3) version='batch' controlling mFDR mini-batch testing, mini-batch represents grouping tests run asynchronously result dependent p-values. mini-batch tests fully completed, new one can start, testing hypotheses independent previous batch. batch sizes given input batch.sizes version SAFFRONstar algorithm. Given overall significance level \\(\\alpha\\), SAFFRONstar depends constants \\(w_0\\) \\(\\lambda\\), \\(w_0\\) satisfies \\(0 \\le w_0 \\le \\alpha\\) represents intial `wealth' procedure, \\(0 < \\lambda < 1\\) represents threshold `candidate' hypothesis. `candidate' refers p-values smaller \\(\\lambda\\), since SAFFRONstar never reject p-value larger \\(\\lambda\\). algorithms also require sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. Note SAFFRONstar algorithms control modified FDR (mFDR). `async' version also controls usual FDR p-values assumed independent. details SAFFRONstar algorithms can found Zrnic et al. (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"Zrnic, T., Ramdas, . Jordan, M.. (2021). Asynchronous Online Testing Multiple Hypotheses. Journal Machine Learning Research, 22:1-33.","code":""},{"path":[]},{"path":"https://dsrobertson.github.io/onlineFDR/reference/SAFFRONstar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SAFFRONstar: Adaptive online mFDR control for asynchronous testing — SAFFRONstar","text":"","code":"sample.df <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), decision.times = seq_len(15) + 1)  SAFFRONstar(sample.df, version='async') #>          pval      alphai R #> 1  2.9000e-08 0.005468627 1 #> 2  6.7430e-02 0.001803974 0 #> 3  1.5140e-02 0.007272601 0 #> 4  8.1740e-02 0.003607948 0 #> 5  1.7100e-03 0.003607948 1 #> 6  3.6000e-05 0.003607948 1 #> 7  7.9149e-01 0.014545202 0 #> 8  2.7201e-01 0.018153151 0 #> 9  2.8295e-01 0.007379710 0 #> 10 7.5900e-08 0.007379710 1 #> 11 6.9274e-01 0.007379710 0 #> 12 3.0443e-01 0.018316965 0 #> 13 1.3600e-03 0.007874188 1 #> 14 7.2342e-01 0.007874188 0 #> 15 5.4757e-01 0.018811442 0  sample.df2 <- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), lags = rep(1,15))  SAFFRONstar(sample.df2, version='dep') #>          pval lag      alphai R #> 1  2.9000e-08   1 0.005468627 1 #> 2  6.7430e-02   1 0.001803974 0 #> 3  1.5140e-02   1 0.007272601 0 #> 4  8.1740e-02   1 0.003607948 0 #> 5  1.7100e-03   1 0.003607948 1 #> 6  3.6000e-05   1 0.003607948 1 #> 7  7.9149e-01   1 0.014545202 0 #> 8  2.7201e-01   1 0.018153151 0 #> 9  2.8295e-01   1 0.007379710 0 #> 10 7.5900e-08   1 0.007379710 1 #> 11 6.9274e-01   1 0.007379710 0 #> 12 3.0443e-01   1 0.018316965 0 #> 13 1.3600e-03   1 0.007874188 1 #> 14 7.2342e-01   1 0.007874188 0 #> 15 5.4757e-01   1 0.018811442 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/setBound.html","id":null,"dir":"Reference","previous_headings":"","what":"setBound — setBound","title":"setBound — setBound","text":"Calculates default sequence non-negative numbers \\(\\gamma_i\\) sum 1, given upper bound \\(N\\) number hypotheses tested.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/setBound.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"setBound — setBound","text":"","code":"setBound(alg, alpha = 0.05, N)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/setBound.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"setBound — setBound","text":"alg string takes value one following: LOND, LORD, LORDdep, SAFFRON, ADDIS, LONDstar, LORDstar, SAFFRONstar, Alpha_investing alpha Overall significance level FDR procedure, default 0.05. bounds LOND LORDdep depend alpha. N upper bound number hypotheses tested","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/setBound.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"setBound — setBound","text":"bound vector giving values default sequence \\(\\gamma_i\\) nonnegative numbers.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":null,"dir":"Reference","previous_headings":"","what":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"Implements Storey-BH algorithm offline FDR control, presented Storey (2002).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"","code":"StoreyBH(d, alpha = 0.05, lambda = 0.5)"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"d Either vector p-values, dataframe column: p-value (`pval'). alpha Overall significance level FDR procedure, default 0.05. lambda Threshold Storey-BH, must 0 1. Defaults 0.5.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"ordered_d dataframe original data d   indicator function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\((r/n)\\alpha\\),   \\(r\\) rank \\(\\)-th p-value within ordered set   \\(n\\) total number hypotheses. hypothesis \\(\\)   rejected, R[] = 1 (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"function takes input either vector p-values, dataframe column p-values (`pval').","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"Storey, J.D. (2002). direct approach false discovery rates.   J. R. Statist. Soc. B: 64, Part 3, 479-498.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/StoreyBH.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"StoreyBH: Offline FDR control using the St-BH procedure — StoreyBH","text":"","code":"pvals <- c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757)  StoreyBH(pvals) #>          pval R #> 1  2.9000e-08 1 #> 2  6.7430e-02 0 #> 3  1.5140e-02 1 #> 4  8.1740e-02 0 #> 5  1.7100e-03 1 #> 6  3.6000e-05 1 #> 7  7.9149e-01 0 #> 8  2.7201e-01 0 #> 9  2.8295e-01 0 #> 10 7.5900e-08 1 #> 11 6.9274e-01 0 #> 12 3.0443e-01 0 #> 13 1.3600e-03 1 #> 14 7.2342e-01 0 #> 15 5.4757e-01 0"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":null,"dir":"Reference","previous_headings":"","what":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"Implements supLORD procedure, controls FDX FDR, including FDR stopping times, presented Xu Ramdas (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"","code":"supLORD(   d,   delta = 0.05,   eps,   r,   eta,   rho,   gammai,   random = TRUE,   display_progress = FALSE,   date.format = \"%Y-%m-%d\" )"},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"d Either vector p-values, dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). column dates provided, p-values treated ordered sequence, arriving one time. delta probability FDP exceeds eps (time step making r rejections). Must 0 1, defaults 0.05. eps upper bound FDP. Must 0 1. r threshold rejections error control begins apply. Must positive integer. eta Controls pace wealth spent function algorithm's current wealth. Must positive real number. rho Controls length time spending sequence exhausts wealth earned rejection. Must positive integer. gammai Optional vector \\(\\gamma_i\\). default provided proposed Javanmard Montanari (2018). random Logical. TRUE (default), order p-values batch (.e. exactly date) randomised. display_progress Logical. TRUE prints progress bar algorithm runtime. date.format Optional string giving format used dates.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"d.dataframe original data d (  reordered batches random = TRUE),   supLORD-adjusted significance thresholds \\(\\alpha_i\\) indicator   function discoveries R. Hypothesis \\(\\) rejected   \\(\\)-th p-value less equal \\(\\alpha_i\\), case   R[] = 1  (otherwise R[] = 0).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"function takes input either vector p-values dataframe three columns: identifier (`id'), date (`date') p-value (`pval'). case p-values arrive batches corresponds multiple instances date. column dates provided, p-values treated ordered sequence, arriving one time.. supLORD procedure provably controls FDX p-values conditionally superuniform null. supLORD also controls supFDR hence FDR (even stopping times). Given overall significance level \\(\\alpha\\), choose sequence non-negative non-increasing numbers \\(\\gamma_i\\) sum 1. supLORD requires user specify r, threshold rejections error control begins apply, eps, upper bound false discovery proportion (FDP), delta, probability FDP exceeds eps time step making r rejections. well, user specify variables eta, controls pace wealth spent (function algorithm's current wealth), rho, controls length time spending sequence exhausts wealth earned rejection. details supLORD procedure can found Xu Ramdas (2021).","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"Xu, Z. Ramdas, . (2021). Dynamic Algorithms Online Multiple Testing. Annual Conference Mathematical Scientific Machine Learning, PMLR, 145:955-986.","code":""},{"path":"https://dsrobertson.github.io/onlineFDR/reference/supLORD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD","text":"","code":"set.seed(1) N <- 1000 B <- rbinom(N, 1, 0.5) Z <- rnorm(N, mean = 3*B) pval <- pnorm(-Z)  out <- supLORD(pval, eps=0.15, r=30, eta=0.05, rho=30, random=FALSE) head(out) #>              d       alphai R #> 1 4.691912e-01 0.0019301522 0 #> 2 6.167166e-01 0.0004197471 0 #> 3 3.462711e-02 0.0003575072 0 #> 4 1.300690e-03 0.0002973164 0 #> 5 1.606961e-01 0.0002520627 0 #> 6 2.174486e-06 0.0002180533 1 sum(out$R) #> [1] 390"}]
