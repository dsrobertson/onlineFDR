<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The theory behind onlineFDR • onlineFDR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="The theory behind onlineFDR">
<meta property="og:description" content="onlineFDR">
<meta property="og:image" content="https://dsrobertson.github.io/onlineFDR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">onlineFDR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/onlineFDR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced-usage.html">Advanced usage of onlineFDR</a>
    </li>
    <li>
      <a href="../articles/theory.html">The theory behind onlineFDR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The theory behind onlineFDR</h1>
            
      
      
      <div class="hidden name"><code>theory.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="fdr-control">FDR Control<a class="anchor" aria-label="anchor" href="#fdr-control"></a>
</h2>
<p>Consider a sequence of hypotheses <span class="math inline">\(H_1,
H_2, H_3, \ldots\)</span> that arrive sequentially in a stream, with
corresponding <span class="math inline">\(p\)</span>-values <span class="math inline">\((p_1, p_2, p_3, \ldots)\)</span>. A testing
procedure provides a sequence of adjusted significance thresholds <span class="math inline">\(\alpha_i\)</span>, with corresponding decision
rule: <span class="math display">\[
R_i = \left\{\begin{array}{ccc}
1 &amp; \text{if } p_i \leq \alpha_i &amp; (\text{reject } H_i)\\
0 &amp; \text{otherwise } &amp; (\text{accept } H_i)
\end{array}\right\}
\]</span></p>
<p>In <em>online</em> testing, the significance thresholds can only be
functions of the prior decisions, i.e. <span class="math inline">\(\alpha_i = \alpha_i(R_1, R_2, \ldots,
R_{i-1})\)</span>.</p>
<p>Javanmard and Montanari (2015, 2018) proposed two procedures for
online control. The first is LOND, which stands for (significance)
Levels based On Number of Discoveries. The second is LORD, which stands
for (significance) Levels based On Recent Discovery. LORD was
subsequently extended by Ramdas <em>et al.</em> (2017). Ramdas <em>et
al.</em> (2018) also proposed the SAFFRON procedure, which provides an
adaptive method of online FDR control, which includes a variant of
Alpha-investing. Finally, Tian &amp; Ramdas (2019) proposed the ADDIS
procedure as an improvement of SAFFRON in the presence of conservative
nulls.</p>
<div class="section level3">
<h3 id="LOND">LOND<a class="anchor" aria-label="anchor" href="#LOND"></a>
</h3>
<p>The LOND procedure controls the FDR for independent or positively
dependent (PRDS) <span class="math inline">\(p\)</span>-values. Given an
overall significance level <span class="math inline">\(\alpha\)</span>,
we choose a sequence of non-negative numbers <span class="math inline">\(\beta = (\beta_i)_{i \in \mathbb{N}}\)</span> such
that they sum to <span class="math inline">\(\alpha\)</span>. The values
of the adjusted significance thresholds <span class="math inline">\(\alpha_i\)</span> are chosen as follows: <span class="math display">\[ \alpha_i = \beta_i (D(i-1) + 1) \]</span> where
<span class="math inline">\(D(n) = \sum_{i=1}^n R_i\)</span> denotes the
number of discoveries (i.e. rejections) in the first <span class="math inline">\(n\)</span> hypotheses tested.</p>
<p>LOND can be adjusted to also control FDR under arbitrarily dependent
<span class="math inline">\(p\)</span>-values. To do so, it is modified
with <span class="math inline">\(\tilde{\beta}_i = \beta_i/H(i)\)</span>
in place of <span class="math inline">\(\beta_i\)</span>, where <span class="math inline">\(H(i) = \sum_{j=1}^i \frac{1}{j}\)</span> is the
<span class="math inline">\(i\)</span>-th harmonic number. Note that
this leads to a substantial loss in power compared to the unadjusted
LOND procedure. The correction factor is similar to the classical one
used by Benjamini and Yekutieli (2001), except that in this case the
<span class="math inline">\(i\)</span>-th hypothesis among <span class="math inline">\(N\)</span> is penalised by a factor of <span class="math inline">\(H(i)\)</span> to give consistent results across
time (as compared to a factor <span class="math inline">\(H(N)\)</span>
for the Benjamini and Yekutieli method).</p>
<p><a name="LOND_beta"></a> The default sequence of <span class="math inline">\(\beta\)</span> is given by <span class="math display">\[\beta_j = C \alpha \frac{\log(\max(j, 2))}{j
e^{\sqrt{\log j}}}\]</span> where <span class="math inline">\(C \approx
0.07720838\)</span>, as proposed by Javanmard and Montanari (2018)
equation 31.</p>
</div>
<div class="section level3">
<h3 id="LORD">LORD<a class="anchor" aria-label="anchor" href="#LORD"></a>
</h3>
<p>The LORD procedure controls the FDR for independent <span class="math inline">\(p\)</span>-values. We first fix a sequence of
non-negative numbers <span class="math inline">\(\gamma = (\gamma_i)_{i
\in \mathbb{N}}\)</span> such that <span class="math inline">\(\gamma_i
\geq \gamma_j\)</span> for <span class="math inline">\(i \leq j\)</span>
and <span class="math inline">\(\sum_{i=1}^{\infty} \gamma_i =
1\)</span>. At each time <span class="math inline">\(i\)</span>, let
<span class="math inline">\(\tau_i\)</span> be the last time a discovery
was made before <span class="math inline">\(i\)</span>: <span class="math display">\[
\tau_i = \max \left\{ l \in \{1, \ldots, i-1\} : R_l = 1\right\}
\]</span></p>
<p>LORD depends on constants <span class="math inline">\(w_0\)</span>
and <span class="math inline">\(b_0\)</span>, where <span class="math inline">\(w_0 \geq 0\)</span> represents the initial
‘wealth’ of the procedure and <span class="math inline">\(b_0 &gt;
0\)</span> represents the ‘payout’ for rejecting a hypothesis. We
require <span class="math inline">\(w_0+b_0 \leq \alpha\)</span> for FDR
control to hold.</p>
<p>Javanmard and Montanari (2018) presented three different versions of
LORD, which have different definitions of the adjusted significance
thresholds <span class="math inline">\(\alpha_i\)</span>. Versions 1 and
2 have since been superseded by the LORD++ procedure of Ramdas <em>et
al.</em> (2017), so we do not describe them here.</p>
<ul>
<li><p><strong>LORD++</strong>: The significance thresholds for LORD++
are chosen as follows: <span class="math display">\[
\alpha_i = \gamma_i w_0 + (\alpha - w_0) \gamma_{i-\tau_1} +
\alpha \sum_{j : \tau_j &lt; i, \tau_j \neq \tau_1} \gamma_{i - \tau_j}
\]</span></p></li>
<li><p><strong>LORD 3</strong>: The significance thresholds depend on
the time of the last discovery time and the wealth accumulated at that
time, with <span class="math display">\[
\alpha_i  = \gamma_{i - \tau_i} W(\tau_i)
\]</span> where <span class="math inline">\(\tau_1 = 0\)</span>. Here
<span class="math inline">\(\{W(j)\}_{j \geq 0}\)</span> represents the
‘wealth’ available at time <span class="math inline">\(j\)</span>, and
is defined recursively:</p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
W(0) &amp;= w_0 \\
W(j) &amp;= W(j-1) - \alpha_{j-1} + b_0 R_j
\end{aligned}
\]</span></p>
<ul>
<li>
<strong>D-LORD</strong>: This is equivalent to the LORD++ procedure
with discarding. Given a discarding threshold <span class="math inline">\(\tau \in (0,1)\)</span> and initial wealth <span class="math inline">\(w_0 \leq \tau\alpha\)</span> the significance
thresholds are chosen as follows: <span class="math display">\[
\alpha_t = \min\{\tau, \tilde{\alpha}_t\}
\]</span> where <span class="math display">\[
\tilde{\alpha}_t = w_0 \gamma_{S^t} +
(\tau\alpha - w_0)\gamma_{S^t - \kappa_1^*} +
\tau\alpha \sum_{j \geq 2} \gamma_{S^t - \kappa_j^*}
\]</span> and <span class="math display">\[
\kappa_j = \min\{i \in [t-1] : \sum_{k \leq i}
1 \{p_k \leq \alpha_k\} \geq j\}, \;
\kappa_j^* = \sum_{i \leq \kappa_j} 1 \{p_i \leq \tau \}, \;
S^t = \sum_{i &lt; t} 1 \{p_i \leq \tau \}
\]</span>
</li>
</ul>
<p>LORD++ is an instance of a monotone rule, and provably controls the
FDR for independent p-values provided <span class="math inline">\(w_0
\leq \alpha\)</span>. LORD 3 is a non-monotone rule, and FDR control is
only demonstrated empirically. In some scenarios with large <span class="math inline">\(N\)</span>, LORD 3 will have a slightly higher
power than LORD++ (see Robertson <em>et al.</em>, 2018), but since it is
a non-monotone rule we would recommend using LORD++ (which is the
default), especially since it also has a provable guarantee of FDR
control.</p>
<p><a name="LORD_gamma"></a> In all versions, the default sequence of
<span class="math inline">\(\gamma\)</span> is given by <span class="math display">\[\gamma_j = C \frac{\log(\max(j, 2))}{j
e^{\sqrt{\log j}}}\]</span> where <span class="math inline">\(C \approx
0.07720838\)</span>, as proposed by Javanmard and Montanari (2018)
equation 31.</p>
<p>Javanmard and Montanari (2018) also proposed an adjusted version of
LORD that is valid for arbitrarily <em>dependent</em> p-values.
Similarly to LORD 3, the adjusted significance thresholds are set equal
to <span class="math display">\[ \alpha_i = \xi_i W(\tau_i)\]</span>
where (assuming <span class="math inline">\(w_0 \leq b_0\)</span>),
<span class="math inline">\(\sum_{j=1}^{\infty} \xi_i (1 + \log(j)) \leq
\alpha / b_0\)</span></p>
<p><a name="LORDdep_xi"></a> The default sequence of <span class="math inline">\(\xi\)</span> is given by <span class="math display">\[ \xi_j  = \frac{C \alpha }{b_0 j \log(\max(j,
2))^3}\]</span> where <span class="math inline">\(C \approx
0.139307\)</span>.</p>
<p>Note that allowing for dependent p-values can lead to a substantial
loss in power compared with the LORD procedures described above.</p>
</div>
<div class="section level3">
<h3 id="SAFFRON">SAFFRON<a class="anchor" aria-label="anchor" href="#SAFFRON"></a>
</h3>
<p>The SAFFRON procedure controls the FDR for independent p-values, and
was proposed by Ramdas <em>et al.</em> (2018). The algorithm is based on
an estimate of the proportion of true null hypotheses. More precisely,
SAFFRON sets the adjusted test levels based on an estimate of the amount
of alpha-wealth that is allocated to testing the true null
hypotheses.</p>
<p>SAFFRON depends on constants <span class="math inline">\(w_0\)</span>
and <span class="math inline">\(\lambda\)</span>, where <span class="math inline">\(w_0\)</span> satisfies <span class="math inline">\(0 \leq w_0 &lt; (1 - \lambda)\alpha\)</span> and
represents the initial ‘wealth’ of the procedure, and <span class="math inline">\(\lambda \in (0,1)\)</span> represents the
threshold for a ‘candidate’ hypothesis. A ‘candidate’ refers to p-values
smaller than <span class="math inline">\(\lambda\)</span>, since SAFFRON
will never reject a p-value larger than <span class="math inline">\(\lambda\)</span>. These candidates can be thought
of as the hypotheses that are a-priori more likely to be non-null.</p>
<p>The SAFFRON procedure runs as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Set the initial alpha-wealth <span class="math inline">\(w_0 &lt;
(1-\lambda)\alpha\)</span></p></li>
<li><p>At each time <span class="math inline">\(i\)</span>, define the
number of candidates after the <span class="math inline">\(k\)</span>-th
rejection as <span class="math display">\[ C_{k+} = C_{k+}(i) = \sum_{j
= \tau_k + 1}^{i-1} C_j\]</span> where <span class="math inline">\(C_j =
1\{p_j \leq \lambda \}\)</span> is the indicator for candidacy.</p></li>
<li><p>SAFFRON starts with <span class="math inline">\(\alpha_1 =
\min\{\gamma_1 w_0, \lambda\}\)</span>. Subsequent test levels are
chosen as <span class="math inline">\(\alpha_i = \min\{ \lambda,
\tilde{\alpha}_i\}\)</span>, where <span class="math display">\[
\tilde{\alpha}_i = w_0 \gamma_{i-C_{0+}} +
((1-\lambda)\alpha - w_0)\gamma_{i-\tau_1-C_{1+}} +
(1-\lambda)\alpha \sum_{j : \tau_j &lt; i, \tau_j \neq \tau_1}
\gamma_{i - \tau_j- C_{j+}}
\]</span></p></li>
</ol>
<p><a name="SAFFRON_gamma"></a> The default sequence of <span class="math inline">\(\gamma\)</span> for SAFFRON is given by <span class="math inline">\(\gamma_j \propto j^{-1.6}\)</span>.</p>
</div>
<div class="section level3">
<h3 id="AlphaInvesting">Alpha-investing<a class="anchor" aria-label="anchor" href="#AlphaInvesting"></a>
</h3>
<p>Ramdas et al. (2018) proposed a variant of the Alpha-investing
algorithm of Foster and Stine (2008) that guarantees FDR control for
independent p-values. This procedure uses SAFFRON’s update rule with the
constant <span class="math inline">\(\lambda\)</span> replaced by a
sequence <span class="math inline">\(\lambda_i = \alpha_i\)</span>. This
is also equivalent to using the ADDIS algorithm (see below) with <span class="math inline">\(\tau = 1\)</span> and <span class="math inline">\(\lambda_i = \alpha_i\)</span>.</p>
</div>
<div class="section level3">
<h3 id="ADDIS">ADDIS<a class="anchor" aria-label="anchor" href="#ADDIS"></a>
</h3>
<p>The ADDIS procedure controls the FDR for independent p-values, and
was proposed by Tian &amp; Ramdas (2019). The algorithm compensates for
the power loss of SAFFRON with conservative nulls, by including both
adaptivity in the fraction of null hypotheses (like SAFFRON) and the
conservativeness of nulls (unlike SAFFRON).</p>
<p>ADDIS depends on constants <span class="math inline">\(w_0,
\lambda\)</span> and <span class="math inline">\(\tau\)</span>. <span class="math inline">\(w_0\)</span> represents the initial `wealth’ of
the procedure and satisfies <span class="math inline">\(0 \leq w_0 \leq
\tau \lambda \alpha\)</span>. <span class="math inline">\(\tau \in
(0,1)\)</span> represents the threshold for a hypothesis to be selected
for testing: p-values greater than <span class="math inline">\(\tau\)</span> are implicitly ‘discarded’ by the
procedure. Finally, <span class="math inline">\(\lambda \in
(0,1)\)</span> sets the threshold for a p-value to be a candidate for
rejection: ADDIS will never reject a p-value larger than <span class="math inline">\(\tau \lambda\)</span>.</p>
<p>The significance thresholds for ADDIS are chosen as follows: <span class="math display">\[
\alpha_t = \min\{\tau\lambda, \tilde{\alpha}_t\}
\]</span> where <span class="math display">\[
\tilde{\alpha}_t = w_0 \gamma_{S^t-C_{0+}} +
(\tau(1-\lambda)\alpha - w_0)\gamma_{S^t - \kappa_1^*-C_{1+}} +
\tau(1-\lambda)\alpha \sum_{j \geq 2} \gamma_{S^t - \kappa_j^* - C_{j+}}
\]</span> and <span class="math display">\[
\kappa_j = \min\{i \in [t-1] : \sum_{k \leq i}
1 \{p_k \leq \alpha_k\} \geq j\}, \;
\kappa_j^* = \sum_{i \leq \kappa_j} 1 \{p_i \leq \tau \}, \;
S^t = \sum_{i &lt; t} 1 \{p_i \leq \tau \}, \;
C_{j+} = \sum_{i = \tau_k + 1}^{t-1} 1\{p_i \leq \tau\}
\]</span></p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span>
for ADDIS is the same as for SAFFRON given <a href="#SAFFRON_gamma">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="fwer-control">FWER Control<a class="anchor" aria-label="anchor" href="#fwer-control"></a>
</h2>
<div class="section level3">
<h3 id="Alpha-spending">Alpha-spending<a class="anchor" aria-label="anchor" href="#Alpha-spending"></a>
</h3>
<p>The Alpha-spending procedure controls the FWER for a potentially
infinite stream of p-values using a Bonferroni-like test. Given an
overall significance level <span class="math inline">\(\alpha\)</span>,
the significance thresholds are chosen as <span class="math display">\[\alpha_i = \alpha \gamma_i\]</span> where <span class="math inline">\(\sum_{i=1}^{\infty} \gamma_i = 1\)</span> and
<span class="math inline">\(\gamma_i \geq 0\)</span>. The procedure
strongly controls the FWER for arbitrarily dependent p-values.</p>
<p>Note that the procedure also controls the generalised familywise
error rate (k-FWER) for <span class="math inline">\(k &gt; 1\)</span> if
<span class="math inline">\(\alpha\)</span> is replaced by <span class="math inline">\(\min(1,k\alpha)\)</span>.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span>
is the same as that for <span class="math inline">\(\xi\)</span> for
LORD given <a href="#LORD_gamma">here</a>.</p>
</div>
<div class="section level3">
<h3 id="onlineFallback">Online Fallback<a class="anchor" aria-label="anchor" href="#onlineFallback"></a>
</h3>
<p>The online fallback procedure of Tian &amp; Ramdas (2019b) provides a
uniformly more powerful method than Alpha-spending, by saving the
significance level of a previous rejection. More specifically, online
fallback tests hypothesis <span class="math inline">\(H_i\)</span> at
level <span class="math display">\[\alpha_i = \alpha \gamma_i + R_{i-1}
\alpha_{i-1}\]</span> where <span class="math inline">\(R_i = 1\{p_i
\leq \alpha_i\}\)</span> denotes a rejected hypothesis. The procedure
strongly controls the FWER for arbitrarily dependent p-values.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span>
is the same as that for <span class="math inline">\(\xi\)</span> for
LORD given <a href="#LORD_gamma">here</a>.</p>
</div>
<div class="section level3">
<h3 id="ADDIS-spending">ADDIS-spending<a class="anchor" aria-label="anchor" href="#ADDIS-spending"></a>
</h3>
<p>The ADDIS-spending procedure strongly controls the FWER for
independent p-values, and was proposed by Tian &amp; Ramdas (2019b). The
procedure compensates for the power loss of Alpha-spending, by including
both adapativity in the fraction of null hypotheses and the
conservativeness of nulls.</p>
<p>ADDIS depends on constants <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\tau\)</span>, where <span class="math inline">\(\lambda &lt; \tau\)</span>. Here <span class="math inline">\(\tau \in (0,1)\)</span> represents the threshold
for a hypothesis to be selected for testing: p-values greater than <span class="math inline">\(\tau\)</span> are implicitly `discarded’ by the
procedure, while <span class="math inline">\(\lambda \in (0,1)\)</span>
sets the threshold for a p-value to be a candidate for rejection:
ADDIS-spending will never reject a p-value larger than <span class="math inline">\(\lambda\)</span>.</p>
<p>Note that the procedure controls the generalised familywise error
rate (k-FWER) for <span class="math inline">\(k &gt; 1\)</span> if <span class="math inline">\(\alpha\)</span> is replaced by <span class="math inline">\(\min(1,k\alpha)\)</span>. Tian and Ramdas (2019b)
also presented a version for handling local dependence, see the Section
on Asynchronous testing below.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span>
for ADDIS-spending is the same as for SAFFRON given <a href="#SAFFRON_gamma">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="accounting-for-dependent-p-values">Accounting for dependent p-values<a class="anchor" aria-label="anchor" href="#accounting-for-dependent-p-values"></a>
</h2>
<p>As noted above, the LORD, SAFFRON, ADDIS and ADDIS-spending
procedures assume independent p-values, while the LOND procedure is also
valid under positive dependencies (like the Benjamini-Hochberg method,
see below). Adjusted versions of LOND and LORD available for arbitrarily
dependent p-values. Alpha-spending and online fallback also control the
FWER and FDR for arbitrarily dependent p-values.</p>
<p>By way of comparison, the usual Benjamini-Hochberg method for
controlling the FDR assumes that the p-values are positively dependent
(PRDS). As an example, the PRDS is satisfied for multivariate normal
test statistics with a positive correlation matrix). See Benjamini &amp;
Yekutieli (2001) for further technical details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '4c638d00ee22961d7aab55c43dd0309d',
    indexName: 'onlinefdr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
