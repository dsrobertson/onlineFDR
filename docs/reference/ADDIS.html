<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS • onlineFDR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ADDIS: Adaptive discarding algorithm for online FDR control — ADDIS"><meta name="description" content="Implements the ADDIS algorithm for online FDR control, where ADDIS stands for
an ADaptive algorithm that DIScards conservative nulls, as presented by Tian
and Ramdas (2019). The algorithm compensates for the power loss of SAFFRON
with conservative nulls, by including both adaptivity in the fraction of
null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike
SAFFRON)."><meta property="og:description" content="Implements the ADDIS algorithm for online FDR control, where ADDIS stands for
an ADaptive algorithm that DIScards conservative nulls, as presented by Tian
and Ramdas (2019). The algorithm compensates for the power loss of SAFFRON
with conservative nulls, by including both adaptivity in the fraction of
null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike
SAFFRON)."><meta property="og:image" content="https://dsrobertson.github.io/onlineFDR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">onlineFDR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/onlineFDR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ADDIS: Adaptive discarding algorithm for online FDR control</h1>

      <div class="d-none name"><code>ADDIS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the ADDIS algorithm for online FDR control, where ADDIS stands for
an ADaptive algorithm that DIScards conservative nulls, as presented by Tian
and Ramdas (2019). The algorithm compensates for the power loss of SAFFRON
with conservative nulls, by including both adaptivity in the fraction of
null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike
SAFFRON).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ADDIS</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">gammai</span>,</span>
<span>  <span class="va">w0</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  async <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  date.format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Either a vector of p-values, or a dataframe with three columns: an
identifier (`id'), p-value (`pval'), and decision times
(`decision.times').</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Overall significance level of the procedure, the default is
0.05.</p></dd>


<dt id="arg-gammai">gammai<a class="anchor" aria-label="anchor" href="#arg-gammai"></a></dt>
<dd><p>Optional vector of \(\gamma_i\). A default is provided with
\(\gamma_j\) proportional to \(1/j^(1.6)\).</p></dd>


<dt id="arg-w-">w0<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Initial `wealth' of the procedure, defaults to \(\alpha/2\).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional parameter that sets the threshold for `candidate'
hypotheses. Must be between 0 and tau, defaults to 0.25.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Optional threshold for hypotheses to be selected for testing. Must
be between 0 and 1, defaults to 0.5.</p></dd>


<dt id="arg-async">async<a class="anchor" aria-label="anchor" href="#arg-async"></a></dt>
<dd><p>Logical. If <code>TRUE</code> runs the version for an asynchronous
testing process. Defaults to FALSE.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (the default), then the order of the
p-values in each batch (i.e. those that have exactly the same date) is
randomised. Only needed if async=FALSE.</p></dd>


<dt id="arg-display-progress">display_progress<a class="anchor" aria-label="anchor" href="#arg-display-progress"></a></dt>
<dd><p>Logical. If <code>TRUE</code> prints out a progress bar for the algorithm runtime.</p></dd>


<dt id="arg-date-format">date.format<a class="anchor" aria-label="anchor" href="#arg-date-format"></a></dt>
<dd><p>Optional string giving the format that is used for dates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>out</dt>
<dd><p>A dataframe with the original p-values <code>pval</code>, the
  adjusted testing levels \(\alpha_i\) and the indicator function of
  discoveries <code>R</code>. Hypothesis \(i\) is rejected if the \(i\)-th
  p-value is less than or equal to \(\alpha_i\), in which case <code>R[i] =
  1</code>  (otherwise <code>R[i] = 0</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function takes as its input either a vector of p-values, or a dataframe
with three columns. The dataframe requires an identifier (`id'),
date (`date') and p-value (`pval'). If the asynchronous
version is specified (see below), then the column date should be replaced
by the decision times.</p>
<p>Given an overall significance level \(\alpha\), ADDIS depends on constants
\(w_0\), \(\lambda\) and \(\tau\). Here \(w_0\) represents the
initial `wealth' of the procedure and satisfies \(0 \le w_0 \le \alpha\).
\(\tau \in (0,1)\) represents the threshold for a
hypothesis to be selected for testing: p-values greater than \(\tau\) are
implicitly `discarded' by the procedure. Finally, \(\lambda \in [0,\tau)\)
sets the threshold for a p-value to be a candidate for rejection: ADDIS will
never reject a p-value larger than \(\lambda\). The algorithm also
require a sequence of non-negative non-increasing numbers \(\gamma_i\) that
sum to 1.</p>
<p>The ADDIS procedure provably controls the FDR for independent p-values. Tian
and Ramdas (2019) also presented a version for an asynchronous testing
process, consisting of tests that start and finish at (potentially) random
times. The discretised finish times of the test correspond to the decision
times. These decision times are given as the input <code>decision.times</code>.
Note that this asynchronous version controls a modified version of the FDR.</p>
<p>Further details of the ADDIS algorithms can be found in Tian and Ramdas
(2019).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tian, J. and Ramdas, A. (2019). ADDIS: an adaptive discarding
  algorithm for online FDR control with conservative nulls.
  <em>Advances in Neural Information Processing Systems</em>, 9388-9396.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>ADDIS is identical to <code><a href="SAFFRON.html">SAFFRON</a></code> with option <code>discard=TRUE</code>.</p>
<p>ADDIS with option <code>async=TRUE</code> is identical to <code><a href="SAFFRONstar.html">SAFFRONstar</a></code>
with option <code>discard=TRUE</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sample.df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A15432'</span>, <span class="st">'B90969'</span>, <span class="st">'C18705'</span>, <span class="st">'B49731'</span>, <span class="st">'E99902'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'C38292'</span>, <span class="st">'A30619'</span>, <span class="st">'D46627'</span>, <span class="st">'E29198'</span>, <span class="st">'A41418'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'D51456'</span>, <span class="st">'C88669'</span>, <span class="st">'E03673'</span>, <span class="st">'A63155'</span>, <span class="st">'B66033'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2014-12-01'</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2015-09-21'</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2016-05-19'</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="st">'2016-11-12'</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2017-03-27'</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.90e-08</span>, <span class="fl">0.06743</span>, <span class="fl">0.01514</span>, <span class="fl">0.08174</span>, <span class="fl">0.00171</span>,</span></span>
<span class="r-in"><span>        <span class="fl">3.60e-05</span>, <span class="fl">0.79149</span>, <span class="fl">0.27201</span>, <span class="fl">0.28295</span>, <span class="fl">7.59e-08</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.69274</span>, <span class="fl">0.30443</span>, <span class="fl">0.00136</span>, <span class="fl">0.72342</span>, <span class="fl">0.54757</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ADDIS</span><span class="op">(</span><span class="va">sample.df1</span>, random<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pval      alphai R     id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2.9000e-08 0.002734314 1 A15432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  6.7430e-02 0.005468627 0 B90969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.5140e-02 0.005468627 0 C18705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8.1740e-02 0.005468627 0 B49731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.7100e-03 0.005468627 1 E99902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3.6000e-05 0.010937254 1 C38292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  7.9149e-01 0.016405881 0 A30619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2.7201e-01 0.016405881 0 D46627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.8295e-01 0.005411923 0 E29198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 7.5900e-08 0.002828822 1 A41418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 6.9274e-01 0.008297449 0 D51456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3.0443e-01 0.008297449 0 C88669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1.3600e-03 0.003589243 1 E03673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 7.2342e-01 0.009057870 0 A63155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 5.4757e-01 0.009057870 0 B66033</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sample.df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A15432'</span>, <span class="st">'B90969'</span>, <span class="st">'C18705'</span>, <span class="st">'B49731'</span>, <span class="st">'E99902'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'C38292'</span>, <span class="st">'A30619'</span>, <span class="st">'D46627'</span>, <span class="st">'E29198'</span>, <span class="st">'A41418'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'D51456'</span>, <span class="st">'C88669'</span>, <span class="st">'E03673'</span>, <span class="st">'A63155'</span>, <span class="st">'B66033'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.90e-08</span>, <span class="fl">0.06743</span>, <span class="fl">0.01514</span>, <span class="fl">0.08174</span>, <span class="fl">0.00171</span>,</span></span>
<span class="r-in"><span>        <span class="fl">3.60e-05</span>, <span class="fl">0.79149</span>, <span class="fl">0.27201</span>, <span class="fl">0.28295</span>, <span class="fl">7.59e-08</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.69274</span>, <span class="fl">0.30443</span>, <span class="fl">0.00136</span>, <span class="fl">0.72342</span>, <span class="fl">0.54757</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>decision.times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ADDIS</span><span class="op">(</span><span class="va">sample.df2</span>, async <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Asynchronous</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pval       alphai R     id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2.9000e-08 0.0027343135 1 A15432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  6.7430e-02 0.0009019871 0 B90969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.5140e-02 0.0018039742 0 C18705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8.1740e-02 0.0018039742 0 B49731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.7100e-03 0.0018039742 1 E99902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3.6000e-05 0.0018039742 1 C38292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  7.9149e-01 0.0036079483 0 A30619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2.7201e-01 0.0054119225 0 D46627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.8295e-01 0.0054119225 0 E29198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 7.5900e-08 0.0028288216 1 A41418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 6.9274e-01 0.0017852686 0 D51456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3.0443e-01 0.0035892428 0 C88669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1.3600e-03 0.0035892428 1 E03673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 7.2342e-01 0.0021921853 0 A63155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 5.4757e-01 0.0039961595 0 B66033</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

