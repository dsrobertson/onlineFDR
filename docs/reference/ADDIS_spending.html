<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending • onlineFDR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS_spending"><meta name="description" content="Implements the ADDIS algorithm for online FWER control, where ADDIS stands
for an ADaptive algorithm that DIScards conservative nulls, as presented by
Tian and Ramdas (2021). The procedure compensates for the power loss of
Alpha-spending, by including both adaptivity in the fraction of null
hypotheses and the conservativeness of nulls."><meta property="og:description" content="Implements the ADDIS algorithm for online FWER control, where ADDIS stands
for an ADaptive algorithm that DIScards conservative nulls, as presented by
Tian and Ramdas (2021). The procedure compensates for the power loss of
Alpha-spending, by including both adaptivity in the fraction of null
hypotheses and the conservativeness of nulls."><meta property="og:image" content="https://dsrobertson.github.io/onlineFDR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">onlineFDR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/onlineFDR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ADDIS-spending: Adaptive discarding algorithm for online FWER control</h1>

      <div class="d-none name"><code>ADDIS_spending.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the ADDIS algorithm for online FWER control, where ADDIS stands
for an ADaptive algorithm that DIScards conservative nulls, as presented by
Tian and Ramdas (2021). The procedure compensates for the power loss of
Alpha-spending, by including both adaptivity in the fraction of null
hypotheses and the conservativeness of nulls.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ADDIS_spending</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">gammai</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  dep <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Either a vector of p-values, or a dataframe with three columns: an
identifier (`id'), p-value (`pval'), and lags (`lags').</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Overall significance level of the procedure, the default is
0.05.</p></dd>


<dt id="arg-gammai">gammai<a class="anchor" aria-label="anchor" href="#arg-gammai"></a></dt>
<dd><p>Optional vector of \(\gamma_i\). A default is provided with
\(\gamma_j\) proportional to \(1/j^(1.6)\).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional parameter that sets the threshold for `candidate'
hypotheses. Must be between 0 and 1, defaults to 0.25.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Optional threshold for hypotheses to be selected for testing. Must
be between 0 and 1, defaults to 0.5.</p></dd>


<dt id="arg-dep">dep<a class="anchor" aria-label="anchor" href="#arg-dep"></a></dt>
<dd><p>Logical. If <code>TRUE</code> runs the version for locally dependent
p-values</p></dd>


<dt id="arg-display-progress">display_progress<a class="anchor" aria-label="anchor" href="#arg-display-progress"></a></dt>
<dd><p>Logical. If <code>TRUE</code> prints out a progress bar for the algorithm runtime.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>out</dt>
<dd><p>A dataframe with the original p-values <code>pval</code>, the
  adjusted testing levels \(\alpha_i\) and the indicator function of
  discoveries <code>R</code>. Hypothesis \(i\) is rejected if the \(i\)-th
  p-value is less than or equal to \(\alpha_i\), in which case <code>R[i] =
  1</code>  (otherwise <code>R[i] = 0</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function takes as its input either a vector of p-values, or a dataframe
with three columns: an identifier (`id'), p-value (`pval'), and lags, if the
dependent version is specified (see below). Given an overall significance
level \(\alpha\), ADDIS depends on constants \(\lambda\) and \(\tau\),
where \(\lambda &lt; \tau\). Here \(\tau \in (0,1)\) represents the
threshold for a hypothesis to be selected for testing: p-values greater than
\(\tau\) are implicitly `discarded' by the procedure, while \(\lambda
\in (0,1)\) sets the threshold for a p-value to be a candidate for rejection:
ADDIS-spending will never reject a p-value larger than \(\lambda\). The
algorithms also require a sequence of non-negative non-increasing numbers
\(\gamma_i\) that sum to 1.</p>
<p>The ADDIS-spending procedure provably controls the FWER in the strong sense
for independent p-values. Note that the procedure also controls the
generalised familywise error rate (k-FWER) for \(k &gt; 1\) if \(\alpha\) is
replaced by min(\(1, k\alpha\)).</p>
<p>Tian and Ramdas (2021) also presented a version for handling local
dependence. More precisely, for any \(t&gt;0\) we allow the p-value \(p_t\)
to have arbitrary dependence on the previous \(L_t\) p-values. The fixed
sequence \(L_t\) is referred to as `lags', and is given as the input
<code>lags</code> for this version of the ADDIS-spending algorithm.</p>
<p>Further details of the ADDIS-spending algorithms can be found in Tian and
Ramdas (2021).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tian, J. and Ramdas, A. (2021). Online control of the familywise
  error rate. <em>Statistical Methods for Medical Research</em> 30(4):976–993.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ADDIS.html">ADDIS</a></code> provides online control of the FDR.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sample.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A15432'</span>, <span class="st">'B90969'</span>, <span class="st">'C18705'</span>, <span class="st">'B49731'</span>, <span class="st">'E99902'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'C38292'</span>, <span class="st">'A30619'</span>, <span class="st">'D46627'</span>, <span class="st">'E29198'</span>, <span class="st">'A41418'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'D51456'</span>, <span class="st">'C88669'</span>, <span class="st">'E03673'</span>, <span class="st">'A63155'</span>, <span class="st">'B66033'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.90e-08</span>, <span class="fl">0.06743</span>, <span class="fl">0.01514</span>, <span class="fl">0.08174</span>, <span class="fl">0.00171</span>,</span></span>
<span class="r-in"><span>        <span class="fl">3.60e-05</span>, <span class="fl">0.79149</span>, <span class="fl">0.27201</span>, <span class="fl">0.28295</span>, <span class="fl">7.59e-08</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.69274</span>, <span class="fl">0.30443</span>, <span class="fl">0.00136</span>, <span class="fl">0.72342</span>, <span class="fl">0.54757</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>lags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ADDIS_spending</span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span> <span class="co">#independent</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pval       alphai R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2.9000e-08 0.0054686271 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  6.7430e-02 0.0054686271 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.5140e-02 0.0054686271 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8.1740e-02 0.0054686271 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.7100e-03 0.0054686271 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3.6000e-05 0.0054686271 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  7.9149e-01 0.0054686271 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2.7201e-01 0.0054686271 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.8295e-01 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 7.5900e-08 0.0009429405 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 6.9274e-01 0.0009429405 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3.0443e-01 0.0009429405 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1.3600e-03 0.0005950895 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 7.2342e-01 0.0005950895 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 5.4757e-01 0.0005950895 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ADDIS_spending</span><span class="op">(</span><span class="va">sample.df</span>, dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#Locally dependent</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pval       alphai R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2.9000e-08 0.0054686271 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  6.7430e-02 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.5140e-02 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8.1740e-02 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.7100e-03 0.0018039742 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3.6000e-05 0.0018039742 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  7.9149e-01 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2.7201e-01 0.0018039742 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.8295e-01 0.0009429405 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 7.5900e-08 0.0005950895 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 6.9274e-01 0.0005950895 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3.0443e-01 0.0005950895 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1.3600e-03 0.0004164149 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 7.2342e-01 0.0004164149 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 5.4757e-01 0.0004164149 0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

