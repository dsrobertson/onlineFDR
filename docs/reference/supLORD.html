<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD • onlineFDR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times — supLORD"><meta name="description" content="Implements the supLORD procedure, which controls both FDX and FDR, including
the FDR at stopping times, as presented by Xu and Ramdas (2021)."><meta property="og:description" content="Implements the supLORD procedure, which controls both FDX and FDR, including
the FDR at stopping times, as presented by Xu and Ramdas (2021)."><meta property="og:image" content="https://dsrobertson.github.io/onlineFDR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">onlineFDR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/onlineFDR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>supLORD: Online control of the false discovery exceedance (FDX) and the FDR at stopping times</h1>

      <div class="d-none name"><code>supLORD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the supLORD procedure, which controls both FDX and FDR, including
the FDR at stopping times, as presented by Xu and Ramdas (2021).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">supLORD</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">eps</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  <span class="va">eta</span>,</span>
<span>  <span class="va">rho</span>,</span>
<span>  <span class="va">gammai</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  date.format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Either a vector of p-values, or a dataframe with three columns: an
identifier (`id'), date (`date') and p-value (`pval'). If no column of
dates is provided, then the p-values are treated as being ordered
in sequence, arriving one at a time.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>The probability at which the FDP exceeds eps (at any time step
after making r rejections). Must be between 0 and 1, defaults to 0.05.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>The upper bound on the FDP. Must be between 0 and 1.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>The threshold of rejections after which the error control
begins to apply. Must be a positive integer.</p></dd>


<dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>Controls the pace at which wealth is spent as a function of the
algorithm's current wealth. Must be a positive real number.</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>Controls the length of time before the spending sequence exhausts
the wealth earned from a rejection. Must be a positive integer.</p></dd>


<dt id="arg-gammai">gammai<a class="anchor" aria-label="anchor" href="#arg-gammai"></a></dt>
<dd><p>Optional vector of \(\gamma_i\). A default is provided as
proposed by Javanmard and Montanari (2018).</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (the default), then the order of the
p-values in each batch (i.e. those that have exactly the same date) is
randomised.</p></dd>


<dt id="arg-display-progress">display_progress<a class="anchor" aria-label="anchor" href="#arg-display-progress"></a></dt>
<dd><p>Logical. If <code>TRUE</code> prints out a progress bar for
the algorithm runtime.</p></dd>


<dt id="arg-date-format">date.format<a class="anchor" aria-label="anchor" href="#arg-date-format"></a></dt>
<dd><p>Optional string giving the format that is used for dates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>d.out</dt>
<dd><p>A dataframe with the original data <code>d</code> (which
  will be reordered if there are batches and <code>random = TRUE</code>), the
  supLORD-adjusted significance thresholds \(\alpha_i\) and the indicator
  function of discoveries <code>R</code>. Hypothesis \(i\) is rejected if the
  \(i\)-th p-value is less than or equal to \(\alpha_i\), in which case
  <code>R[i] = 1</code>  (otherwise <code>R[i] = 0</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function takes as its input either a vector of p-values or a dataframe
with three columns: an identifier (`id'), date (`date') and p-value (`pval').
The case where p-values arrive in batches corresponds to multiple instances
of the same date. If no column of dates is provided, then the p-values are
treated as being ordered in sequence, arriving one at a time..</p>
<p>The supLORD procedure provably controls the FDX for p-values that are
conditionally superuniform under the null. supLORD also controls the supFDR
and hence the FDR (even at stopping times). Given an overall significance
level \(\alpha\), we choose a sequence of non-negative non-increasing
numbers \(\gamma_i\) that sum to 1.</p>
<p>supLORD requires the user to specify r, a threshold of rejections after which
the error control begins to apply, eps, the upper bound on the false
discovery proportion (FDP), and delta, the probability at which the FDP
exceeds eps at any time step after making r rejections. As well, the user
should specify the variables eta, which controls the pace at which wealth is
spent (as a function of the algorithm's current wealth), and rho, which
controls the length of time before the spending sequence exhausts
the wealth earned from a rejection.</p>
<p>Further details of the supLORD procedure can be found in Xu and Ramdas (2021).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Xu, Z. and Ramdas, A. (2021). Dynamic Algorithms for Online
Multiple Testing. <em>Annual Conference on Mathematical and Scientific
Machine Learning</em>, PMLR, 145:955-986.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="va">B</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">supLORD</span><span class="op">(</span><span class="va">pval</span>, eps<span class="op">=</span><span class="fl">0.15</span>, r<span class="op">=</span><span class="fl">30</span>, eta<span class="op">=</span><span class="fl">0.05</span>, rho<span class="op">=</span><span class="fl">30</span>, random<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              d       alphai R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4.691912e-01 0.0019301522 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 6.167166e-01 0.0004197471 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.462711e-02 0.0003575072 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.300690e-03 0.0002973164 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.606961e-01 0.0002520627 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2.174486e-06 0.0002180533 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">R</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 390</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

