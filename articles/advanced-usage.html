<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced usage of onlineFDR • onlineFDR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Advanced usage of onlineFDR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">onlineFDR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/onlineFDR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced-usage.html">Advanced usage of onlineFDR</a>
    </li>
    <li>
      <a href="../articles/theory.html">The theory behind onlineFDR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>

    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced usage of onlineFDR</h1>
            
      

      <div class="hidden name"><code>advanced-usage.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="brief-background-of-the-onlinefdr-algorithms">Brief Background of the <code>onlineFDR</code> algorithms<a class="anchor" aria-label="anchor" href="#brief-background-of-the-onlinefdr-algorithms"></a>
</h2>
<p>Javanmard and Montanari proposed two procedures, LOND and LORD, to
control the FDR in an online manner (Javanmard and Montanari (2015,
2018)), with the latter extended by Ramdas <em>et al.</em> (2017). The
LOND procedure sets the adjusted significance thresholds based on the
number of discoveries made so far, while LORD sets them according to the
time of the most recent discovery. Ramdas <em>et al.</em> (2018) then
proposed the SAFFRON procedure, which provides an adaptive method of
online FDR control. They also proposed a variant of the Alpha-investing
algorithm of Foster and Stine (2008) that guarantees FDR control, using
SAFFRON’s update rule.</p>
<p>Subsequently, Zrnic <em>et al.</em> (2021) proposed procedures to
control the modified FDR (mFDR) in the context of <em>asynchronous</em>
testing, i.e. where each hypothesis test can itself be a sequential
process and the tests can overlap in time. They presented asynchronous
versions of the LOND, LORD and SAFFRON procedures for a variety of trial
settings. For both synchronous and asynchronous testing, Tian &amp;
Ramdas (2019) proposed the ADDIS algorithms which compensate for the
loss in power in the presence of conservative nulls by adaptively
‘discarding’ these p-values.</p>
<p>Finally, Tian &amp; Ramdas (2021) proposed procedures that provide
online control of the FWER. One procedure, online fallback, gives a
uniform improvement to the naive Alpha-spending procedure (see below).
The ADDIS-spending procedure compensates for the power loss of these
procedures by including both adapativity in the fraction of null
hypotheses and the conservativeness of nulls.</p>
</div>
<div class="section level2">
<h2 id="variations-to-the-default-options">Variations to the default options<a class="anchor" aria-label="anchor" href="#variations-to-the-default-options"></a>
</h2>
<p>In the following section, we consider the arguments that a typical
user might consider amending for their analysis.</p>
<div class="section level3">
<h3 id="common-arguments">Common arguments<a class="anchor" aria-label="anchor" href="#common-arguments"></a>
</h3>
<p>As a default, the <code>alpha</code> argument is set to 0.05, where
<code>alpha</code> sets the overall significance level of the FDR of
FWER controlling procedure. By convention, the standard significance
level utilised is the 5%. However, there are applications where an
alternate threshold could be considered. For example, a more stringent
threshold might be appropriate when there are limited resources to
follow up significant findings. A less stringent threshold might be
appropriate when the downstream analysis is a global analysis which can
tolerate a higher proportion of false positives.</p>
<p>To ensure correct interpretation of the dates provided there is a
date.format argument. As a default, the date format is set to receive
dates as year-month(00-12)-day(number). The following website provides
clear guidance on symbols used to interpret the date information: <a href="https://www.statmethods.net/input/dates.html" class="external-link uri">https://www.statmethods.net/input/dates.html</a></p>
<p>As a default, the <code>random</code> argument is set to
<code>TRUE</code>. In this situation, the order of p-values in each
batch (i.e. with the same date) are randomised. This is to avoid the
risk of p-values being ordered post-hoc, which can lead to an inflation
of the FDR. As the dataset grows the data is reprocessed. To ensure the
consistency of the output (with the randomisation within the previous
batches remaining the same), it is necessary to set the same
<code>seed</code> for all analyses.</p>
<p>The user also has the option to turn off the randomisation step, by
setting the <code>random</code> argument to <code>FALSE</code>. This
approach would be appropriate if the user has both a date <em>and</em> a
time stamp for the p-values, in which case the data should be ordered by
date and time beforehand and then passed to a wrapper function. Another
scenario would be when p-values within the batches are ordered using
<em>independent</em> side information, so that hypotheses most likely to
be rejected come first, which would potentially increase the power of
the procedure (see Javanmard and Montanari (2018) and Li and Barber
(2017)).</p>
</div>
<div class="section level3">
<h3 id="lond">LOND<a class="anchor" aria-label="anchor" href="#lond"></a>
</h3>
<p>As a default, the <code>dep</code> argument is set to
<code>FALSE</code>. Alternatively, this can be set to <code>TRUE</code>
and will implement the LOND procedure to guarantee FDR control for
arbitrarily dependent p-values. This method will in general be more
conservative.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LOND.html">LOND</a></span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span>    <span class="co"># for independent p-values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LOND.html">LOND</a></span><span class="op">(</span><span class="va">sample.df</span>, dep<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># for dependent p-values</span></span>
<span></span>
<span><span class="co"># compare adjusted significance thresholds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>independent <span class="op">=</span> <span class="va">results.indep</span><span class="op">$</span><span class="va">alphai</span>, dependent <span class="op">=</span> <span class="va">results.dep</span><span class="op">$</span><span class="va">alphai</span><span class="op">)</span></span>
<span><span class="co">#&gt;        independent    dependent</span></span>
<span><span class="co">#&gt;  [1,] 0.0026758385 0.0026758385</span></span>
<span><span class="co">#&gt;  [2,] 0.0011638206 0.0007758804</span></span>
<span><span class="co">#&gt;  [3,] 0.0009912499 0.0005406818</span></span>
<span><span class="co">#&gt;  [4,] 0.0008243606 0.0003956931</span></span>
<span><span class="co">#&gt;  [5,] 0.0006988870 0.0003060819</span></span>
<span><span class="co">#&gt;  [6,] 0.0006045900 0.0002467714</span></span>
<span><span class="co">#&gt;  [7,] 0.0005319444 0.0002051576</span></span>
<span><span class="co">#&gt;  [8,] 0.0007117838 0.0002618915</span></span>
<span><span class="co">#&gt;  [9,] 0.0006421423 0.0002269882</span></span>
<span><span class="co">#&gt; [10,] 0.0007796504 0.0002661860</span></span>
<span><span class="co">#&gt; [11,] 0.0007155186 0.0002369363</span></span>
<span><span class="co">#&gt; [12,] 0.0006610273 0.0002130140</span></span>
<span><span class="co">#&gt; [13,] 0.0006141682 0.0001931265</span></span>
<span><span class="co">#&gt; [14,] 0.0005734509 0.0001763616</span></span>
<span><span class="co">#&gt; [15,] 0.0005377472 0.0001620585</span></span></code></pre></div>
<p>The vector <code>betai</code> is supplied by default, but can
optionally be specified by the user (as described above, see the formula
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math><a href="#LOND_beta">here</a>).</p>
</div>
<div class="section level3">
<h3 id="lord">LORD<a class="anchor" aria-label="anchor" href="#lord"></a>
</h3>
<p>The default version of LORD used is version ‘++’, but the user can
optionally specify versions 3, ‘discard’ and ‘dep’ using the
<code>version</code> argument (see <a href="#LORD">here</a> for further
details about the different versions).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.discard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="st">'discard'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="st">'dep'</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># compare adjusted significance thresholds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>LORD.plus <span class="op">=</span> <span class="va">results.LORD.plus</span><span class="op">$</span><span class="va">alphai</span>,</span>
<span>    LORD3 <span class="op">=</span> <span class="va">results.LORD3</span><span class="op">$</span><span class="va">alphai</span>,</span>
<span>    LORD.discard  <span class="op">=</span> <span class="va">results.LORD.discard</span><span class="op">$</span><span class="va">alphai</span>,</span>
<span>    LORD.dep <span class="op">=</span> <span class="va">results.LORD.dep</span><span class="op">$</span><span class="va">alphai</span><span class="op">)</span></span>
<span><span class="co">#&gt;          LORD.plus        LORD3 LORD.discard     LORD.dep</span></span>
<span><span class="co">#&gt;  [1,] 0.0002675839 0.0002675839 0.0002675839 2.091542e-03</span></span>
<span><span class="co">#&gt;  [2,] 0.0024664457 0.0026615183 0.0011285264 1.002025e-02</span></span>
<span><span class="co">#&gt;  [3,] 0.0005732818 0.0005787961 0.0002823266 1.677763e-03</span></span>
<span><span class="co">#&gt;  [4,] 0.0004872805 0.0004929725 0.0002394680 6.262659e-04</span></span>
<span><span class="co">#&gt;  [5,] 0.0004059066 0.0004099744 0.0001998165 3.201787e-04</span></span>
<span><span class="co">#&gt;  [6,] 0.0003447286 0.0003475734 0.0001700069 1.933725e-04</span></span>
<span><span class="co">#&gt;  [7,] 0.0002986627 0.0003006772 0.0001475152 1.293954e-04</span></span>
<span><span class="co">#&gt;  [8,] 0.0029389397 0.0072216015 0.0014680343 1.548152e-04</span></span>
<span><span class="co">#&gt;  [9,] 0.0008168502 0.0015704700 0.0014680343 1.166482e-04</span></span>
<span><span class="co">#&gt; [10,] 0.0033835974 0.0091593329 0.0017451837 1.422614e-04</span></span>
<span><span class="co">#&gt; [11,] 0.0011873999 0.0019918653 0.0006438778 1.145119e-04</span></span>
<span><span class="co">#&gt; [12,] 0.0010225858 0.0016965126 0.0006438778 9.432408e-05</span></span>
<span><span class="co">#&gt; [13,] 0.0008785607 0.0014108836 0.0006438778 7.916885e-05</span></span>
<span><span class="co">#&gt; [14,] 0.0007679398 0.0011961369 0.0005497556 6.749313e-05</span></span>
<span><span class="co">#&gt; [15,] 0.0006820264 0.0010347488 0.0005497556 5.830055e-05</span></span></code></pre></div>
<p>By default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mi>α</mi><mi>/</mi><mn>10</mn></mrow><annotation encoding="application/x-tex">w_0 = \alpha/10</annotation></semantics></math>
and (for LORD 3 and LORD dep)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>0</mn><mo>=</mo><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>−</mo><mi>w</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">b0 = alpha - w0</annotation></semantics></math>,
but these parameters can optionally be specified by the user subject to
the requirements that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>w</mi><mn>0</mn></msub><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">0 \leq w_0 \leq \alpha</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b_0 &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>0</mn></msub><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">w_0+b_0 \leq \alpha</annotation></semantics></math>.</p>
<p>The value of <code>gammai</code> is also supplied by default, but can
optionally be specified by the user (as described above, see the formula
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_j</annotation></semantics></math><a href="#LORDdep_xi">here</a> for version=‘dep’ and <a href="#LORD_gamma">here</a> for all other versions of LORD).</p>
</div>
<div class="section level3">
<h3 id="saffron">SAFFRON<a class="anchor" aria-label="anchor" href="#saffron"></a>
</h3>
<p>By default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">w_0 = \alpha/2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.5</annotation></semantics></math>,
but these parameters can optionally be specified by the user subject to
the requirements that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>w</mi><mn>0</mn></msub><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">0 \leq w_0 \leq \alpha</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>λ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \lambda &lt; 1</annotation></semantics></math>.
The values of <code>gammai</code> are also supplied by default, but can
optionally be specified by the user (as described above, see the formula
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_j</annotation></semantics></math><a href="#SAFFRON_gamma">here</a>).</p>
</div>
<div class="section level3">
<h3 id="addis">ADDIS<a class="anchor" aria-label="anchor" href="#addis"></a>
</h3>
<p>By default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">w_0 = \alpha/2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau = 0.5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.25</annotation></semantics></math>,
but these parameters can optionally be specified by the user subject to
the requirements that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>w</mi><mn>0</mn></msub><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">0 \leq w_0 &lt; \alpha</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>τ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \tau &lt; 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>λ</mi><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">0 &lt; \lambda &lt; \tau</annotation></semantics></math>.
The values of <code>gammai</code> are also supplied by default, but can
optionally be specified by the user.</p>
</div>
<div class="section level3">
<h3 id="alpha-spending-and-online-fallback">Alpha-spending and online fallback<a class="anchor" aria-label="anchor" href="#alpha-spending-and-online-fallback"></a>
</h3>
<p>The values of <code>gammai</code> are supplied by default, but can
optionally be specified by the user.</p>
</div>
<div class="section level3">
<h3 id="addis-spending">ADDIS-spending<a class="anchor" aria-label="anchor" href="#addis-spending"></a>
</h3>
<p>By default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.25</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau = 0.5</annotation></semantics></math>,
but these parameters can optionally be specified by the user subject to
the requirements that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\lambda &lt; \tau</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>λ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \lambda &lt; 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>τ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \tau &lt; 1</annotation></semantics></math>.
The values of <code>gammai</code> are also supplied by default, but can
optionally be specified by the user.</p>
</div>
<div class="section level3">
<h3 id="asynchronous-testing">Asynchronous testing<a class="anchor" aria-label="anchor" href="#asynchronous-testing"></a>
</h3>
<p>Zrnic <em>et al.</em> (2021) proposed procedures to control the
modified FDR (mFDR) in the context of <em>asynchronous</em> testing,
i.e. where each hypothesis test can itself be a sequential process and
the tests can overlap in time. They presented asynchronous versions of
the LOND, LORD and SAFFRON procedures for a variety of trial settings,
including the following:</p>
<p>1: <strong>Asynchronous online mFDR control</strong>: This is for an
asynchronous testing process, consisting of tests that start and finish
at (potentially) random times. The discretised finish times of the test
correspond to the decision times.</p>
<p>2: <strong>Online mFDR control under local dependence</strong>: For
any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation></semantics></math>
we allow the p-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_t</annotation></semantics></math>
to have arbitrary dependence on the previous
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>t</mi></msub><annotation encoding="application/x-tex">L_t</annotation></semantics></math>
p-values. The fixed sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>t</mi></msub><annotation encoding="application/x-tex">L_t</annotation></semantics></math>
is referred to as `lags’.</p>
<p>3: <strong>mFDR control in asynchronous mini-batch testing</strong>:
A mini-batch represents a grouping of tests run asynchronously which
result in dependent p-values. Once a mini-batch of tests is fully
completed, a new one can start, testing hypotheses independent of the
previous batch.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: '4c638d00ee22961d7aab55c43dd0309d',
    indexName: 'onlinefdr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
